(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))r(h);new MutationObserver(h=>{for(const l of h)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(h){const l={};return h.integrity&&(l.integrity=h.integrity),h.referrerPolicy&&(l.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?l.credentials="include":h.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(h){if(h.ep)return;h.ep=!0;const l=n(h);fetch(h.href,l)}})();const sh=(o,i)=>o===i,Dn=Symbol("solid-proxy"),Mi={equals:sh};let Ur=Yr;const ne=1,Ri=2,Fr={owned:null,cleanups:null,context:null,owner:null};var G=null;let Cn=null,rh=null,X=null,vt=null,Kt=null,Di=0;function Hr(o,i){const n=X,r=G,h=o.length===0,l=i===void 0?r:i,c=h?Fr:{owned:null,cleanups:null,context:l?l.context:null,owner:l},d=h?o:()=>o(()=>jt(()=>Ni(c)));G=c,X=null;try{return se(d,!0)}finally{X=n,G=r}}function ot(o,i){i=i?Object.assign({},Mi,i):Mi;const n={value:o,observers:null,observerSlots:null,comparator:i.equals||void 0},r=h=>(typeof h=="function"&&(h=h(n.value)),Jr(n,h));return[Kr.bind(n),r]}function Vt(o,i,n){const r=ts(o,i,!1,ne);ni(r)}function oh(o,i,n){Ur=ch;const r=ts(o,i,!1,ne);r.user=!0,Kt?Kt.push(r):ni(r)}function at(o,i,n){n=n?Object.assign({},Mi,n):Mi;const r=ts(o,i,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,ni(r),Kr.bind(r)}function ah(o){return se(o,!1)}function jt(o){if(X===null)return o();const i=X;X=null;try{return o()}finally{X=i}}function Yn(o,i,n){const r=Array.isArray(o);let h,l=n&&n.defer;return c=>{let d;if(r){d=Array(o.length);for(let m=0;m<o.length;m++)d[m]=o[m]()}else d=o();if(l)return l=!1,c;const _=jt(()=>i(d,h,c));return h=d,_}}function wr(o){oh(()=>jt(o))}function qr(o){return G===null||(G.cleanups===null?G.cleanups=[o]:G.cleanups.push(o)),o}function Wr(){return G}function Gr(o,i){const n=G,r=X;G=o,X=null;try{return se(i,!0)}catch(h){es(h)}finally{G=n,X=r}}function hh(o){const i=X,n=G;return Promise.resolve().then(()=>{X=i,G=n;let r;return se(o,!1),X=G=null,r?r.done:void 0})}function Xn(o,i){const n=Symbol("context");return{id:n,Provider:fh(n),defaultValue:o}}function Vr(o){let i;return G&&G.context&&(i=G.context[o.id])!==void 0?i:o.defaultValue}function Qn(o){const i=at(o),n=at(()=>Nn(i()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function Kr(){if(this.sources&&this.state)if(this.state===ne)ni(this);else{const o=vt;vt=null,se(()=>$i(this),!1),vt=o}if(X){const o=this.observers?this.observers.length:0;X.sources?(X.sources.push(this),X.sourceSlots.push(o)):(X.sources=[this],X.sourceSlots=[o]),this.observers?(this.observers.push(X),this.observerSlots.push(X.sources.length-1)):(this.observers=[X],this.observerSlots=[X.sources.length-1])}return this.value}function Jr(o,i,n){let r=o.value;return(!o.comparator||!o.comparator(r,i))&&(o.value=i,o.observers&&o.observers.length&&se(()=>{for(let h=0;h<o.observers.length;h+=1){const l=o.observers[h],c=Cn&&Cn.running;c&&Cn.disposed.has(l),(c?!l.tState:!l.state)&&(l.pure?vt.push(l):Kt.push(l),l.observers&&Xr(l)),c||(l.state=ne)}if(vt.length>1e6)throw vt=[],new Error},!1)),i}function ni(o){if(!o.fn)return;Ni(o);const i=Di;lh(o,o.value,i)}function lh(o,i,n){let r;const h=G,l=X;X=G=o;try{r=o.fn(i)}catch(c){return o.pure&&(o.state=ne,o.owned&&o.owned.forEach(Ni),o.owned=null),o.updatedAt=n+1,es(c)}finally{X=l,G=h}(!o.updatedAt||o.updatedAt<=n)&&(o.updatedAt!=null&&"observers"in o?Jr(o,r):o.value=r,o.updatedAt=n)}function ts(o,i,n,r=ne,h){const l={fn:o,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:i,owner:G,context:G?G.context:null,pure:n};return G===null||G!==Fr&&(G.owned?G.owned.push(l):G.owned=[l]),l}function ji(o){if(o.state===0)return;if(o.state===Ri)return $i(o);if(o.suspense&&jt(o.suspense.inFallback))return o.suspense.effects.push(o);const i=[o];for(;(o=o.owner)&&(!o.updatedAt||o.updatedAt<Di);)o.state&&i.push(o);for(let n=i.length-1;n>=0;n--)if(o=i[n],o.state===ne)ni(o);else if(o.state===Ri){const r=vt;vt=null,se(()=>$i(o,i[0]),!1),vt=r}}function se(o,i){if(vt)return o();let n=!1;i||(vt=[]),Kt?n=!0:Kt=[],Di++;try{const r=o();return uh(n),r}catch(r){n||(Kt=null),vt=null,es(r)}}function uh(o){if(vt&&(Yr(vt),vt=null),o)return;const i=Kt;Kt=null,i.length&&se(()=>Ur(i),!1)}function Yr(o){for(let i=0;i<o.length;i++)ji(o[i])}function ch(o){let i,n=0;for(i=0;i<o.length;i++){const r=o[i];r.user?o[n++]=r:ji(r)}for(i=0;i<n;i++)ji(o[i])}function $i(o,i){o.state=0;for(let n=0;n<o.sources.length;n+=1){const r=o.sources[n];if(r.sources){const h=r.state;h===ne?r!==i&&(!r.updatedAt||r.updatedAt<Di)&&ji(r):h===Ri&&$i(r,i)}}}function Xr(o){for(let i=0;i<o.observers.length;i+=1){const n=o.observers[i];n.state||(n.state=Ri,n.pure?vt.push(n):Kt.push(n),n.observers&&Xr(n))}}function Ni(o){let i;if(o.sources)for(;o.sources.length;){const n=o.sources.pop(),r=o.sourceSlots.pop(),h=n.observers;if(h&&h.length){const l=h.pop(),c=n.observerSlots.pop();r<h.length&&(l.sourceSlots[c]=r,h[r]=l,n.observerSlots[r]=c)}}if(o.owned){for(i=o.owned.length-1;i>=0;i--)Ni(o.owned[i]);o.owned=null}if(o.cleanups){for(i=o.cleanups.length-1;i>=0;i--)o.cleanups[i]();o.cleanups=null}o.state=0}function dh(o){return o instanceof Error?o:new Error(typeof o=="string"?o:"Unknown error",{cause:o})}function es(o,i=G){throw dh(o)}function Nn(o){if(typeof o=="function"&&!o.length)return Nn(o());if(Array.isArray(o)){const i=[];for(let n=0;n<o.length;n++){const r=Nn(o[n]);Array.isArray(r)?i.push.apply(i,r):i.push(r)}return i}return o}function fh(o,i){return function(r){let h;return Vt(()=>h=jt(()=>(G.context={...G.context,[o]:r.value},Qn(()=>r.children))),void 0),h}}function ht(o,i){return jt(()=>o(i||{}))}function Li(){return!0}const _h={get(o,i,n){return i===Dn?n:o.get(i)},has(o,i){return i===Dn?!0:o.has(i)},set:Li,deleteProperty:Li,getOwnPropertyDescriptor(o,i){return{configurable:!0,enumerable:!0,get(){return o.get(i)},set:Li,deleteProperty:Li}},ownKeys(o){return o.keys()}};function On(o){return(o=typeof o=="function"?o():o)?o:{}}function ph(){for(let o=0,i=this.length;o<i;++o){const n=this[o]();if(n!==void 0)return n}}function mh(...o){let i=!1;for(let c=0;c<o.length;c++){const d=o[c];i=i||!!d&&Dn in d,o[c]=typeof d=="function"?(i=!0,at(d)):d}if(i)return new Proxy({get(c){for(let d=o.length-1;d>=0;d--){const _=On(o[d])[c];if(_!==void 0)return _}},has(c){for(let d=o.length-1;d>=0;d--)if(c in On(o[d]))return!0;return!1},keys(){const c=[];for(let d=0;d<o.length;d++)c.push(...Object.keys(On(o[d])));return[...new Set(c)]}},_h);const n={},r=Object.create(null);for(let c=o.length-1;c>=0;c--){const d=o[c];if(!d)continue;const _=Object.getOwnPropertyNames(d);for(let m=_.length-1;m>=0;m--){const p=_[m];if(p==="__proto__"||p==="constructor")continue;const v=Object.getOwnPropertyDescriptor(d,p);if(!r[p])r[p]=v.get?{enumerable:!0,configurable:!0,get:ph.bind(n[p]=[v.get.bind(d)])}:v.value!==void 0?v:void 0;else{const b=n[p];b&&(v.get?b.push(v.get.bind(d)):v.value!==void 0&&b.push(()=>v.value))}}}const h={},l=Object.keys(r);for(let c=l.length-1;c>=0;c--){const d=l[c],_=r[d];_&&_.get?Object.defineProperty(h,d,_):h[d]=_?_.value:void 0}return h}const gh=o=>`Stale read from <${o}>.`;function Qr(o){const i=o.keyed,n=at(()=>o.when,void 0,{equals:(r,h)=>i?r===h:!r==!h});return at(()=>{const r=n();if(r){const h=o.children;return typeof h=="function"&&h.length>0?jt(()=>h(i?r:()=>{if(!jt(n))throw gh("Show");return o.when})):h}return o.fallback},void 0,void 0)}function vh(o,i,n){let r=n.length,h=i.length,l=r,c=0,d=0,_=i[h-1].nextSibling,m=null;for(;c<h||d<l;){if(i[c]===n[d]){c++,d++;continue}for(;i[h-1]===n[l-1];)h--,l--;if(h===c){const p=l<r?d?n[d-1].nextSibling:n[l-d]:_;for(;d<l;)o.insertBefore(n[d++],p)}else if(l===d)for(;c<h;)(!m||!m.has(i[c]))&&i[c].remove(),c++;else if(i[c]===n[l-1]&&n[d]===i[h-1]){const p=i[--h].nextSibling;o.insertBefore(n[d++],i[c++].nextSibling),o.insertBefore(n[--l],p),i[h]=n[l]}else{if(!m){m=new Map;let v=d;for(;v<l;)m.set(n[v],v++)}const p=m.get(i[c]);if(p!=null)if(d<p&&p<l){let v=c,b=1,T;for(;++v<h&&v<l&&!((T=m.get(i[v]))==null||T!==p+b);)b++;if(b>p-d){const S=i[c];for(;d<p;)o.insertBefore(n[d++],S)}else o.replaceChild(n[d++],i[c++])}else c++;else i[c++].remove()}}}const br="_$DX_DELEGATE";function yh(o,i,n,r={}){let h;return Hr(l=>{h=l,i===document?o():gt(i,o(),i.firstChild?null:void 0,n)},r.owner),()=>{h(),i.textContent=""}}function Ot(o,i,n){let r;const h=()=>{const c=document.createElement("template");return c.innerHTML=o,c.content.firstChild},l=()=>(r||(r=h())).cloneNode(!0);return l.cloneNode=l,l}function Zi(o,i=window.document){const n=i[br]||(i[br]=new Set);for(let r=0,h=o.length;r<h;r++){const l=o[r];n.has(l)||(n.add(l),i.addEventListener(l,wh))}}function Pr(o,i,n){return jt(()=>o(i,n))}function gt(o,i,n,r){if(n!==void 0&&!r&&(r=[]),typeof i!="function")return zi(o,i,r,n);Vt(h=>zi(o,i(),h,n),r)}function wh(o){const i=`$$${o.type}`;let n=o.composedPath&&o.composedPath()[0]||o.target;for(o.target!==n&&Object.defineProperty(o,"target",{configurable:!0,value:n}),Object.defineProperty(o,"currentTarget",{configurable:!0,get(){return n||document}});n;){const r=n[i];if(r&&!n.disabled){const h=n[`${i}Data`];if(h!==void 0?r.call(n,h,o):r.call(n,o),o.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function zi(o,i,n,r,h){for(;typeof n=="function";)n=n();if(i===n)return n;const l=typeof i,c=r!==void 0;if(o=c&&n[0]&&n[0].parentNode||o,l==="string"||l==="number"){if(l==="number"&&(i=i.toString(),i===n))return n;if(c){let d=n[0];d&&d.nodeType===3?d.data!==i&&(d.data=i):d=document.createTextNode(i),n=Se(o,n,r,d)}else n!==""&&typeof n=="string"?n=o.firstChild.data=i:n=o.textContent=i}else if(i==null||l==="boolean")n=Se(o,n,r);else{if(l==="function")return Vt(()=>{let d=i();for(;typeof d=="function";)d=d();n=zi(o,d,n,r)}),()=>n;if(Array.isArray(i)){const d=[],_=n&&Array.isArray(n);if(Zn(d,i,n,h))return Vt(()=>n=zi(o,d,n,r,!0)),()=>n;if(d.length===0){if(n=Se(o,n,r),c)return n}else _?n.length===0?xr(o,d,r):vh(o,n,d):(n&&Se(o),xr(o,d));n=d}else if(i.nodeType){if(Array.isArray(n)){if(c)return n=Se(o,n,r,i);Se(o,n,null,i)}else n==null||n===""||!o.firstChild?o.appendChild(i):o.replaceChild(i,o.firstChild);n=i}}return n}function Zn(o,i,n,r){let h=!1;for(let l=0,c=i.length;l<c;l++){let d=i[l],_=n&&n[o.length],m;if(!(d==null||d===!0||d===!1))if((m=typeof d)=="object"&&d.nodeType)o.push(d);else if(Array.isArray(d))h=Zn(o,d,_)||h;else if(m==="function")if(r){for(;typeof d=="function";)d=d();h=Zn(o,Array.isArray(d)?d:[d],Array.isArray(_)?_:[_])||h}else o.push(d),h=!0;else{const p=String(d);_&&_.nodeType===3&&_.data===p?o.push(_):o.push(document.createTextNode(p))}}return h}function xr(o,i,n=null){for(let r=0,h=i.length;r<h;r++)o.insertBefore(i[r],n)}function Se(o,i,n,r){if(n===void 0)return o.textContent="";const h=r||document.createTextNode("");if(i.length){let l=!1;for(let c=i.length-1;c>=0;c--){const d=i[c];if(h!==d){const _=d.parentNode===o;!l&&!c?_?o.replaceChild(h,d):o.insertBefore(h,n):_&&d.remove()}else l=!0}}else o.insertBefore(h,n);return[h]}const bh=!1;function to(){let o=new Set;function i(h){return o.add(h),()=>o.delete(h)}let n=!1;function r(h,l){if(n)return!(n=!1);const c={to:h,options:l,defaultPrevented:!1,preventDefault:()=>c.defaultPrevented=!0};for(const d of o)d.listener({...c,from:d.location,retry:_=>{_&&(n=!0),d.navigate(h,{...l,resolve:!1})}});return!c.defaultPrevented}return{subscribe:i,confirm:r}}let Un;function is(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Un=window.history.state._depth}is();function Ph(o){return{...o,_depth:window.history.state&&window.history.state._depth}}function xh(o,i){let n=!1;return()=>{const r=Un;is();const h=r==null?null:Un-r;if(n){n=!1;return}h&&i(h)?(n=!0,window.history.go(-h)):o()}}const Th=/^(?:[a-z0-9]+:)?\/\//i,kh=/^\/+|(\/)\/+$/g,eo="http://sr";function Xe(o,i=!1){const n=o.replace(kh,"$1");return n?i||/^[?#]/.test(n)?n:"/"+n:""}function Ii(o,i,n){if(Th.test(i))return;const r=Xe(o),h=n&&Xe(n);let l="";return!h||i.startsWith("/")?l=r:h.toLowerCase().indexOf(r.toLowerCase())!==0?l=r+h:l=h,(l||"/")+Xe(i,!l)}function Lh(o,i){if(o==null)throw new Error(i);return o}function Sh(o,i){return Xe(o).replace(/\/*(\*.*)?$/g,"")+Xe(i)}function io(o){const i={};return o.searchParams.forEach((n,r)=>{i[r]=n}),i}function Eh(o,i,n){const[r,h]=o.split("/*",2),l=r.split("/").filter(Boolean),c=l.length;return d=>{const _=d.split("/").filter(Boolean),m=_.length-c;if(m<0||m>0&&h===void 0&&!i)return null;const p={path:c?"":"/",params:{}},v=b=>n===void 0?void 0:n[b];for(let b=0;b<c;b++){const T=l[b],S=_[b],P=T[0]===":",k=P?T.slice(1):T;if(P&&An(S,v(k)))p.params[k]=S;else if(P||!An(S,T))return null;p.path+=`/${S}`}if(h){const b=m?_.slice(-m).join("/"):"";if(An(b,v(h)))p.params[h]=b;else return null}return p}}function An(o,i){const n=r=>r.localeCompare(o,void 0,{sensitivity:"base"})===0;return i===void 0?!0:typeof i=="string"?n(i):typeof i=="function"?i(o):Array.isArray(i)?i.some(n):i instanceof RegExp?i.test(o):!1}function Ch(o){const[i,n]=o.pattern.split("/*",2),r=i.split("/").filter(Boolean);return r.reduce((h,l)=>h+(l.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function no(o){const i=new Map,n=Wr();return new Proxy({},{get(r,h){return i.has(h)||Gr(n,()=>i.set(h,at(()=>o()[h]))),i.get(h)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(o())}})}function so(o){let i=/(\/?\:[^\/]+)\?/.exec(o);if(!i)return[o];let n=o.slice(0,i.index),r=o.slice(i.index+i[0].length);const h=[n,n+=i[1]];for(;i=/^(\/\:[^\/]+)\?/.exec(r);)h.push(n+=i[1]),r=r.slice(i[0].length);return so(r).reduce((l,c)=>[...l,...h.map(d=>d+c)],[])}const Oh=100,ro=Xn(),oo=Xn(),ao=()=>Lh(Vr(ro),"<A> and 'use' router primitives can be only used inside a Route."),ns=()=>ao().navigatorFactory(),Ah=()=>ao().location;function Ih(o,i=""){const{component:n,preload:r,load:h,children:l,info:c}=o,d=!l||Array.isArray(l)&&!l.length,_={key:o,component:n,preload:r||h,info:c};return ho(o.path).reduce((m,p)=>{for(const v of so(p)){const b=Sh(i,v);let T=d?b:b.split("/*",1)[0];T=T.split("/").map(S=>S.startsWith(":")||S.startsWith("*")?S:encodeURIComponent(S)).join("/"),m.push({..._,originalPath:p,pattern:T,matcher:Eh(T,!d,o.matchFilters)})}return m},[])}function Mh(o,i=0){return{routes:o,score:Ch(o[o.length-1])*1e4-i,matcher(n){const r=[];for(let h=o.length-1;h>=0;h--){const l=o[h],c=l.matcher(n);if(!c)return null;r.unshift({...c,route:l})}return r}}}function ho(o){return Array.isArray(o)?o:[o]}function lo(o,i="",n=[],r=[]){const h=ho(o);for(let l=0,c=h.length;l<c;l++){const d=h[l];if(d&&typeof d=="object"){d.hasOwnProperty("path")||(d.path="");const _=Ih(d,i);for(const m of _){n.push(m);const p=Array.isArray(d.children)&&d.children.length===0;if(d.children&&!p)lo(d.children,m.pattern,n,r);else{const v=Mh([...n],r.length);r.push(v)}n.pop()}}}return n.length?r:r.sort((l,c)=>c.score-l.score)}function In(o,i){for(let n=0,r=o.length;n<r;n++){const h=o[n].matcher(i);if(h)return h}return[]}function Rh(o,i){const n=new URL(eo),r=at(_=>{const m=o();try{return new URL(m,n)}catch{return console.error(`Invalid path ${m}`),_}},n,{equals:(_,m)=>_.href===m.href}),h=at(()=>r().pathname),l=at(()=>r().search,!0),c=at(()=>r().hash),d=()=>"";return{get pathname(){return h()},get search(){return l()},get hash(){return c()},get state(){return i()},get key(){return d()},query:no(Yn(l,()=>io(r())))}}let fe;function jh(){return fe}function $h(o,i,n,r={}){const{signal:[h,l],utils:c={}}=o,d=c.parsePath||(V=>V),_=c.renderPath||(V=>V),m=c.beforeLeave||to(),p=Ii("",r.base||"");if(p===void 0)throw new Error(`${p} is not a valid base path`);p&&!h().value&&l({value:p,replace:!0,scroll:!1});const[v,b]=ot(!1);let T;const S=(V,N)=>{N.value===P()&&N.state===C()||(T===void 0&&b(!0),fe=V,T=N,hh(()=>{T===N&&(k(T.value),A(T.state),W[1]([]))}).finally(()=>{T===N&&ah(()=>{fe=void 0,V==="navigate"&&Q(T),b(!1),T=void 0})}))},[P,k]=ot(h().value),[C,A]=ot(h().state),z=Rh(P,C),U=[],W=ot([]),ut=at(()=>typeof r.transformUrl=="function"?In(i(),r.transformUrl(z.pathname)):In(i(),z.pathname)),Nt=no(()=>{const V=ut(),N={};for(let xt=0;xt<V.length;xt++)Object.assign(N,V[xt].params);return N}),Zt={pattern:p,path:()=>p,outlet:()=>null,resolvePath(V){return Ii(p,V)}};return Vt(Yn(h,V=>S("native",V),{defer:!0})),{base:Zt,location:z,params:Nt,isRouting:v,renderPath:_,parsePath:d,navigatorFactory:mt,matches:ut,beforeLeave:m,preloadRoute:wt,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:W};function re(V,N,xt){jt(()=>{if(typeof N=="number"){N&&(c.go?c.go(N):console.warn("Router integration does not support relative routing"));return}const ct=!N||N[0]==="?",{replace:Ut,resolve:M,scroll:ge,state:I}={replace:!1,resolve:!ct,scroll:!0,...xt};let tt;const lt=M?V.resolvePath(N):Ii(ct&&z.pathname||"",N);if(lt===void 0)throw new Error(`Path '${N}' is not a routable path`);if(U.length>=Oh)throw new Error("Too many redirects");const _t=P();(lt!==_t||I!==C())&&(bh||m.confirm(lt,xt)&&(U.push({value:_t,replace:Ut,scroll:ge,state:C()}),S("navigate",{value:lt,state:I})))})}function mt(V){return V=V||Vr(oo)||Zt,(N,xt)=>re(V,N,xt)}function Q(V){const N=U[0];N&&(l({...V,replace:N.replace,scroll:N.scroll}),U.length=0)}function wt(V,N={}){const xt=In(i(),V.pathname),ct=fe;fe="preload";for(let Ut in xt){const{route:M,params:ge}=xt[Ut];M.component&&M.component.preload&&M.component.preload();const{preload:I}=M;N.preloadData&&I&&Gr(n(),()=>I({params:ge,location:{pathname:V.pathname,search:V.search,hash:V.hash,query:io(V),state:null,key:""},intent:"preload"}))}fe=ct}}function zh(o,i,n,r){const{base:h,location:l,params:c}=o,{pattern:d,component:_,preload:m}=r().route,p=at(()=>r().path);_&&_.preload&&_.preload();const v=m?m({params:c,location:l,intent:fe||"initial"}):void 0;return{parent:i,pattern:d,path:p,outlet:()=>_?ht(_,{params:c,location:l,data:v,get children(){return n()}}):n(),resolvePath(T){return Ii(h.path(),T,p())}}}const Bh=o=>i=>{const{base:n}=i,r=Qn(()=>i.children),h=at(()=>lo(r(),i.base||""));let l;const c=$h(o,h,()=>l,{base:n,singleFlight:i.singleFlight,transformUrl:i.transformUrl});return o.create&&o.create(c),ht(ro.Provider,{value:c,get children(){return ht(Dh,{routerState:c,get root(){return i.root},get preload(){return i.rootPreload||i.rootLoad},get children(){return[at(()=>(l=Wr())&&null),ht(Nh,{routerState:c,get branches(){return h()}})]}})}})};function Dh(o){const i=o.routerState.location,n=o.routerState.params,r=at(()=>o.preload&&jt(()=>{o.preload({params:n,location:i,intent:jh()||"initial"})}));return ht(Qr,{get when(){return o.root},keyed:!0,get fallback(){return o.children},children:h=>ht(h,{params:n,location:i,get data(){return r()},get children(){return o.children}})})}function Nh(o){const i=[];let n;const r=at(Yn(o.routerState.matches,(h,l,c)=>{let d=l&&h.length===l.length;const _=[];for(let m=0,p=h.length;m<p;m++){const v=l&&l[m],b=h[m];c&&v&&b.route.key===v.route.key?_[m]=c[m]:(d=!1,i[m]&&i[m](),Hr(T=>{i[m]=T,_[m]=zh(o.routerState,_[m-1]||o.routerState.base,Tr(()=>r()[m+1]),()=>o.routerState.matches()[m])}))}return i.splice(h.length).forEach(m=>m()),c&&d?c:(n=_[0],_)}));return Tr(()=>r()&&n)()}const Tr=o=>()=>ht(Qr,{get when(){return o()},keyed:!0,children:i=>ht(oo.Provider,{value:i,get children(){return i.outlet()}})}),Si=o=>{const i=Qn(()=>o.children);return mh(o,{get children(){return i()}})};function Zh([o,i],n,r){return[o,r?h=>i(r(h)):i]}function Uh(o){if(o==="#")return null;try{return document.querySelector(o)}catch{return null}}function Fh(o){let i=!1;const n=h=>typeof h=="string"?{value:h}:h,r=Zh(ot(n(o.get()),{equals:(h,l)=>h.value===l.value&&h.state===l.state}),void 0,h=>(!i&&o.set(h),h));return o.init&&qr(o.init((h=o.get())=>{i=!0,r[1](n(h)),i=!1})),Bh({signal:r,create:o.create,utils:o.utils})}function Hh(o,i,n){return o.addEventListener(i,n),()=>o.removeEventListener(i,n)}function qh(o,i){const n=Uh(`#${o}`);n?n.scrollIntoView():i&&window.scrollTo(0,0)}const Wh=new Map;function Gh(o=!0,i=!1,n="/_server",r){return h=>{const l=h.base.path(),c=h.navigatorFactory(h.base);let d={};function _(P){return P.namespaceURI==="http://www.w3.org/2000/svg"}function m(P){if(P.defaultPrevented||P.button!==0||P.metaKey||P.altKey||P.ctrlKey||P.shiftKey)return;const k=P.composedPath().find(ut=>ut instanceof Node&&ut.nodeName.toUpperCase()==="A");if(!k||i&&!k.hasAttribute("link"))return;const C=_(k),A=C?k.href.baseVal:k.href;if((C?k.target.baseVal:k.target)||!A&&!k.hasAttribute("state"))return;const U=(k.getAttribute("rel")||"").split(/\s+/);if(k.hasAttribute("download")||U&&U.includes("external"))return;const W=C?new URL(A,document.baseURI):new URL(A);if(!(W.origin!==window.location.origin||l&&W.pathname&&!W.pathname.toLowerCase().startsWith(l.toLowerCase())))return[k,W]}function p(P){const k=m(P);if(!k)return;const[C,A]=k,z=h.parsePath(A.pathname+A.search+A.hash),U=C.getAttribute("state");P.preventDefault(),c(z,{resolve:!1,replace:C.hasAttribute("replace"),scroll:!C.hasAttribute("noscroll"),state:U&&JSON.parse(U)})}function v(P){const k=m(P);if(!k)return;const[C,A]=k;typeof r=="function"&&(A.pathname=r(A.pathname)),d[A.pathname]||h.preloadRoute(A,{preloadData:C.getAttribute("preload")!=="false"})}function b(P){const k=m(P);if(!k)return;const[C,A]=k;typeof r=="function"&&(A.pathname=r(A.pathname)),!d[A.pathname]&&(d[A.pathname]=setTimeout(()=>{h.preloadRoute(A,{preloadData:C.getAttribute("preload")!=="false"}),delete d[A.pathname]},200))}function T(P){const k=m(P);if(!k)return;const[,C]=k;typeof r=="function"&&(C.pathname=r(C.pathname)),d[C.pathname]&&(clearTimeout(d[C.pathname]),delete d[C.pathname])}function S(P){if(P.defaultPrevented)return;let k=P.submitter&&P.submitter.hasAttribute("formaction")?P.submitter.getAttribute("formaction"):P.target.getAttribute("action");if(!k)return;if(!k.startsWith("https://action/")){const A=new URL(k,eo);if(k=h.parsePath(A.pathname+A.search),!k.startsWith(n))return}if(P.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const C=Wh.get(k);if(C){P.preventDefault();const A=new FormData(P.target,P.submitter);C.call({r:h,f:P.target},P.target.enctype==="multipart/form-data"?A:new URLSearchParams(A))}}Zi(["click","submit"]),document.addEventListener("click",p),o&&(document.addEventListener("mouseover",b),document.addEventListener("mouseout",T),document.addEventListener("focusin",v),document.addEventListener("touchstart",v)),document.addEventListener("submit",S),qr(()=>{document.removeEventListener("click",p),o&&(document.removeEventListener("mouseover",b),document.removeEventListener("mouseout",T),document.removeEventListener("focusin",v),document.removeEventListener("touchstart",v)),document.removeEventListener("submit",S)})}}function Vh(o){const i=()=>{const r=window.location.pathname.replace(/^\/+/,"/")+window.location.search,h=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:r+window.location.hash,state:h}},n=to();return Fh({get:i,set({value:r,replace:h,scroll:l,state:c}){h?window.history.replaceState(Ph(c),"",r):window.history.pushState(c,"",r),qh(decodeURIComponent(window.location.hash.slice(1)),l),is()},init:r=>Hh(window,"popstate",xh(r,h=>{if(h&&h<0)return!n.confirm(h);{const l=i();return!n.confirm(l.value,{state:l.state})}})),create:Gh(o.preload,o.explicitLinks,o.actionBase,o.transformUrl),utils:{go:r=>window.history.go(r),beforeLeave:n}})(o)}var Kh=Xn(),Jh=o=>ht(Kh.Provider,{get value(){return o.client},get children(){return o.children}});const Yh="modulepreload",Xh=function(o){return"/"+o},kr={},Ie=function(i,n,r){let h=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));h=Promise.allSettled(n.map(_=>{if(_=Xh(_),_ in kr)return;kr[_]=!0;const m=_.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${p}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":Yh,m||(v.as="script"),v.crossOrigin="",v.href=_,d&&v.setAttribute("nonce",d),document.head.appendChild(v),m)return new Promise((b,T)=>{v.addEventListener("load",b),v.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return h.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return i().catch(l)})},Qh=o=>{let i;return o?i=o:typeof fetch>"u"?i=(...n)=>Ie(async()=>{const{default:r}=await Promise.resolve().then(()=>Re);return{default:r}},void 0).then(({default:r})=>r(...n)):i=fetch,(...n)=>i(...n)};class ss extends Error{constructor(i,n="FunctionsError",r){super(i),this.name=n,this.context=r}}class tl extends ss{constructor(i){super("Failed to send a request to the Edge Function","FunctionsFetchError",i)}}class el extends ss{constructor(i){super("Relay Error invoking the Edge Function","FunctionsRelayError",i)}}class il extends ss{constructor(i){super("Edge Function returned a non-2xx status code","FunctionsHttpError",i)}}var Fn;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Fn||(Fn={}));var nl=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};class sl{constructor(i,{headers:n={},customFetch:r,region:h=Fn.Any}={}){this.url=i,this.headers=n,this.region=h,this.fetch=Qh(r)}setAuth(i){this.headers.Authorization=`Bearer ${i}`}invoke(i,n={}){var r;return nl(this,void 0,void 0,function*(){try{const{headers:h,method:l,body:c}=n;let d={},{region:_}=n;_||(_=this.region),_&&_!=="any"&&(d["x-region"]=_);let m;c&&(h&&!Object.prototype.hasOwnProperty.call(h,"Content-Type")||!h)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(d["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(d["Content-Type"]="application/json",m=JSON.stringify(c)));const p=yield this.fetch(`${this.url}/${i}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),h),body:m}).catch(S=>{throw new tl(S)}),v=p.headers.get("x-relay-error");if(v&&v==="true")throw new el(p);if(!p.ok)throw new il(p);let b=((r=p.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),T;return b==="application/json"?T=yield p.json():b==="application/octet-stream"?T=yield p.blob():b==="text/event-stream"?T=p:b==="multipart/form-data"?T=yield p.formData():T=yield p.text(),{data:T,error:null}}catch(h){return{data:null,error:h}}})}}var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rl(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function ol(o){if(o.__esModule)return o;var i=o.default;if(typeof i=="function"){var n=function r(){return this instanceof r?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};n.prototype=i.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(r){var h=Object.getOwnPropertyDescriptor(o,r);Object.defineProperty(n,r,h.get?h:{enumerable:!0,get:function(){return o[r]}})}),n}var Ct={},rs={},Ui={},si={},Fi={},Hi={},al=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Me=al();const hl=Me.fetch,uo=Me.fetch.bind(Me),co=Me.Headers,ll=Me.Request,ul=Me.Response,Re=Object.freeze(Object.defineProperty({__proto__:null,Headers:co,Request:ll,Response:ul,default:uo,fetch:hl},Symbol.toStringTag,{value:"Module"})),cl=ol(Re);var os={};Object.defineProperty(os,"__esModule",{value:!0});class dl extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}}os.default=dl;var fo=kt&&kt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Hi,"__esModule",{value:!0});const fl=fo(cl),_l=fo(os);let pl=class{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=fl.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,n){return this.headers=Object.assign({},this.headers),this.headers[i]=n,this}then(i,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let h=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,d,_;let m=null,p=null,v=null,b=l.status,T=l.statusText;if(l.ok){if(this.method!=="HEAD"){const C=await l.text();C===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?p=C:p=JSON.parse(C))}const P=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),k=(d=l.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");P&&k&&k.length>1&&(v=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(m={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,v=null,b=406,T="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const P=await l.text();try{m=JSON.parse(P),Array.isArray(m)&&l.status===404&&(p=[],m=null,b=200,T="OK")}catch{l.status===404&&P===""?(b=204,T="No Content"):m={message:P}}if(m&&this.isMaybeSingle&&(!((_=m==null?void 0:m.details)===null||_===void 0)&&_.includes("0 rows"))&&(m=null,b=200,T="OK"),m&&this.shouldThrowOnError)throw new _l.default(m)}return{error:m,data:p,count:v,status:b,statusText:T}});return this.shouldThrowOnError||(h=h.catch(l=>{var c,d,_;return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(d=l==null?void 0:l.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(_=l==null?void 0:l.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),h.then(i,n)}};Hi.default=pl;var ml=kt&&kt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Fi,"__esModule",{value:!0});const gl=ml(Hi);let vl=class extends gl.default{select(i){let n=!1;const r=(i??"*").split("").map(h=>/\s/.test(h)&&!n?"":(h==='"'&&(n=!n),h)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:n=!0,nullsFirst:r,foreignTable:h,referencedTable:l=h}={}){const c=l?`${l}.order`:"order",d=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${d?`${d},`:""}${i}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:n,referencedTable:r=n}={}){const h=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(h,`${i}`),this}range(i,n,{foreignTable:r,referencedTable:h=r}={}){const l=typeof h>"u"?"offset":`${h}.offset`,c=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(c,`${n-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:n=!1,settings:r=!1,buffers:h=!1,wal:l=!1,format:c="text"}={}){var d;const _=[i?"analyze":null,n?"verbose":null,r?"settings":null,h?"buffers":null,l?"wal":null].filter(Boolean).join("|"),m=(d=this.headers.Accept)!==null&&d!==void 0?d:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${m}"; options=${_};`,c==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Fi.default=vl;var yl=kt&&kt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(si,"__esModule",{value:!0});const wl=yl(Fi);let bl=class extends wl.default{eq(i,n){return this.url.searchParams.append(i,`eq.${n}`),this}neq(i,n){return this.url.searchParams.append(i,`neq.${n}`),this}gt(i,n){return this.url.searchParams.append(i,`gt.${n}`),this}gte(i,n){return this.url.searchParams.append(i,`gte.${n}`),this}lt(i,n){return this.url.searchParams.append(i,`lt.${n}`),this}lte(i,n){return this.url.searchParams.append(i,`lte.${n}`),this}like(i,n){return this.url.searchParams.append(i,`like.${n}`),this}likeAllOf(i,n){return this.url.searchParams.append(i,`like(all).{${n.join(",")}}`),this}likeAnyOf(i,n){return this.url.searchParams.append(i,`like(any).{${n.join(",")}}`),this}ilike(i,n){return this.url.searchParams.append(i,`ilike.${n}`),this}ilikeAllOf(i,n){return this.url.searchParams.append(i,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(i,n){return this.url.searchParams.append(i,`ilike(any).{${n.join(",")}}`),this}is(i,n){return this.url.searchParams.append(i,`is.${n}`),this}in(i,n){const r=Array.from(new Set(n)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(i,`in.(${r})`),this}contains(i,n){return typeof n=="string"?this.url.searchParams.append(i,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(i,`cs.{${n.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(n)}`),this}containedBy(i,n){return typeof n=="string"?this.url.searchParams.append(i,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(i,`cd.{${n.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(n)}`),this}rangeGt(i,n){return this.url.searchParams.append(i,`sr.${n}`),this}rangeGte(i,n){return this.url.searchParams.append(i,`nxl.${n}`),this}rangeLt(i,n){return this.url.searchParams.append(i,`sl.${n}`),this}rangeLte(i,n){return this.url.searchParams.append(i,`nxr.${n}`),this}rangeAdjacent(i,n){return this.url.searchParams.append(i,`adj.${n}`),this}overlaps(i,n){return typeof n=="string"?this.url.searchParams.append(i,`ov.${n}`):this.url.searchParams.append(i,`ov.{${n.join(",")}}`),this}textSearch(i,n,{config:r,type:h}={}){let l="";h==="plain"?l="pl":h==="phrase"?l="ph":h==="websearch"&&(l="w");const c=r===void 0?"":`(${r})`;return this.url.searchParams.append(i,`${l}fts${c}.${n}`),this}match(i){return Object.entries(i).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(i,n,r){return this.url.searchParams.append(i,`not.${n}.${r}`),this}or(i,{foreignTable:n,referencedTable:r=n}={}){const h=r?`${r}.or`:"or";return this.url.searchParams.append(h,`(${i})`),this}filter(i,n,r){return this.url.searchParams.append(i,`${n}.${r}`),this}};si.default=bl;var Pl=kt&&kt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ui,"__esModule",{value:!0});const Ke=Pl(si);let xl=class{constructor(i,{headers:n={},schema:r,fetch:h}){this.url=i,this.headers=n,this.schema=r,this.fetch=h}select(i,{head:n=!1,count:r}={}){const h=n?"HEAD":"GET";let l=!1;const c=(i??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),r&&(this.headers.Prefer=`count=${r}`),new Ke.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:n,defaultToNull:r=!0}={}){const h="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),r||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(i)){const c=i.reduce((d,_)=>d.concat(Object.keys(_)),[]);if(c.length>0){const d=[...new Set(c)].map(_=>`"${_}"`);this.url.searchParams.set("columns",d.join(","))}}return new Ke.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:n,ignoreDuplicates:r=!1,count:h,defaultToNull:l=!0}={}){const c="POST",d=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&d.push(this.headers.Prefer),h&&d.push(`count=${h}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(i)){const _=i.reduce((m,p)=>m.concat(Object.keys(p)),[]);if(_.length>0){const m=[...new Set(_)].map(p=>`"${p}"`);this.url.searchParams.set("columns",m.join(","))}}return new Ke.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:n}={}){const r="PATCH",h=[];return this.headers.Prefer&&h.push(this.headers.Prefer),n&&h.push(`count=${n}`),this.headers.Prefer=h.join(","),new Ke.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){const n="DELETE",r=[];return i&&r.push(`count=${i}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Ke.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ui.default=xl;var qi={},Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.version=void 0;Wi.version="0.0.0-automated";Object.defineProperty(qi,"__esModule",{value:!0});qi.DEFAULT_HEADERS=void 0;const Tl=Wi;qi.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Tl.version}`};var _o=kt&&kt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(rs,"__esModule",{value:!0});const kl=_o(Ui),Ll=_o(si),Sl=qi;let El=class po{constructor(i,{headers:n={},schema:r,fetch:h}={}){this.url=i,this.headers=Object.assign(Object.assign({},Sl.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=h}from(i){const n=new URL(`${this.url}/${i}`);return new kl.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new po(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,n={},{head:r=!1,get:h=!1,count:l}={}){let c;const d=new URL(`${this.url}/rpc/${i}`);let _;r||h?(c=r?"HEAD":"GET",Object.entries(n).filter(([p,v])=>v!==void 0).map(([p,v])=>[p,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([p,v])=>{d.searchParams.append(p,v)})):(c="POST",_=n);const m=Object.assign({},this.headers);return l&&(m.Prefer=`count=${l}`),new Ll.default({method:c,url:d,headers:m,schema:this.schemaName,body:_,fetch:this.fetch,allowEmpty:!1})}};rs.default=El;var ri=kt&&kt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.PostgrestBuilder=Ct.PostgrestTransformBuilder=Ct.PostgrestFilterBuilder=Ct.PostgrestQueryBuilder=Ct.PostgrestClient=void 0;const mo=ri(rs);Ct.PostgrestClient=mo.default;const go=ri(Ui);Ct.PostgrestQueryBuilder=go.default;const vo=ri(si);Ct.PostgrestFilterBuilder=vo.default;const yo=ri(Fi);Ct.PostgrestTransformBuilder=yo.default;const wo=ri(Hi);Ct.PostgrestBuilder=wo.default;var Cl=Ct.default={PostgrestClient:mo.default,PostgrestQueryBuilder:go.default,PostgrestFilterBuilder:vo.default,PostgrestTransformBuilder:yo.default,PostgrestBuilder:wo.default};const{PostgrestClient:Ol,PostgrestQueryBuilder:Ec,PostgrestFilterBuilder:Cc,PostgrestTransformBuilder:Oc,PostgrestBuilder:Ac}=Cl,Al="2.10.2",Il={"X-Client-Info":`realtime-js/${Al}`},Ml="1.0.0",bo=1e4,Rl=1e3;var Ae;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(Ae||(Ae={}));var Tt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Tt||(Tt={}));var Rt;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Rt||(Rt={}));var Hn;(function(o){o.websocket="websocket"})(Hn||(Hn={}));var _e;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(_e||(_e={}));class jl{constructor(){this.HEADER_LENGTH=1}decode(i,n){return i.constructor===ArrayBuffer?n(this._binaryDecode(i)):n(typeof i=="string"?JSON.parse(i):{})}_binaryDecode(i){const n=new DataView(i),r=new TextDecoder;return this._decodeBroadcast(i,n,r)}_decodeBroadcast(i,n,r){const h=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=r.decode(i.slice(c,c+h));c=c+h;const _=r.decode(i.slice(c,c+l));c=c+l;const m=JSON.parse(r.decode(i.slice(c,i.byteLength)));return{ref:null,topic:d,event:_,payload:m}}}class Po{constructor(i,n){this.callback=i,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Y;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(Y||(Y={}));const Lr=(o,i,n={})=>{var r;const h=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(i).reduce((l,c)=>(l[c]=$l(c,o,i,h),l),{})},$l=(o,i,n,r)=>{const h=i.find(d=>d.name===o),l=h==null?void 0:h.type,c=n[o];return l&&!r.includes(l)?xo(l,c):qn(c)},xo=(o,i)=>{if(o.charAt(0)==="_"){const n=o.slice(1,o.length);return Nl(i,n)}switch(o){case Y.bool:return zl(i);case Y.float4:case Y.float8:case Y.int2:case Y.int4:case Y.int8:case Y.numeric:case Y.oid:return Bl(i);case Y.json:case Y.jsonb:return Dl(i);case Y.timestamp:return Zl(i);case Y.abstime:case Y.date:case Y.daterange:case Y.int4range:case Y.int8range:case Y.money:case Y.reltime:case Y.text:case Y.time:case Y.timestamptz:case Y.timetz:case Y.tsrange:case Y.tstzrange:return qn(i);default:return qn(i)}},qn=o=>o,zl=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Bl=o=>{if(typeof o=="string"){const i=parseFloat(o);if(!Number.isNaN(i))return i}return o},Dl=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(i){return console.log(`JSON parse error: ${i}`),o}return o},Nl=(o,i)=>{if(typeof o!="string")return o;const n=o.length-1,r=o[n];if(o[0]==="{"&&r==="}"){let l;const c=o.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>xo(i,d))}return o},Zl=o=>typeof o=="string"?o.replace(" ","T"):o,To=o=>{let i=o;return i=i.replace(/^ws/i,"http"),i=i.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),i.replace(/\/+$/,"")};class Mn{constructor(i,n,r={},h=bo){this.channel=i,this.event=n,this.payload=r,this.timeout=h,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(i){this.payload=Object.assign(Object.assign({},this.payload),i)}receive(i,n){var r;return this._hasReceived(i)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:i,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const i=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},i),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(i,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:i,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:n}){this.recHooks.filter(r=>r.status===i).forEach(r=>r.callback(n))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}}var Sr;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Sr||(Sr={}));class Qe{constructor(i,n){this.channel=i,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},h=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qe.syncState(this.state,h,l,c),this.pendingDiffs.forEach(_=>{this.state=Qe.syncDiff(this.state,_,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(r.diff,{},h=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(h):(this.state=Qe.syncDiff(this.state,h,l,c),d())}),this.onJoin((h,l,c)=>{this.channel._trigger("presence",{event:"join",key:h,currentPresences:l,newPresences:c})}),this.onLeave((h,l,c)=>{this.channel._trigger("presence",{event:"leave",key:h,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(i,n,r,h){const l=this.cloneDeep(i),c=this.transformState(n),d={},_={};return this.map(l,(m,p)=>{c[m]||(_[m]=p)}),this.map(c,(m,p)=>{const v=l[m];if(v){const b=p.map(k=>k.presence_ref),T=v.map(k=>k.presence_ref),S=p.filter(k=>T.indexOf(k.presence_ref)<0),P=v.filter(k=>b.indexOf(k.presence_ref)<0);S.length>0&&(d[m]=S),P.length>0&&(_[m]=P)}else d[m]=p}),this.syncDiff(l,{joins:d,leaves:_},r,h)}static syncDiff(i,n,r,h){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),h||(h=()=>{}),this.map(l,(d,_)=>{var m;const p=(m=i[d])!==null&&m!==void 0?m:[];if(i[d]=this.cloneDeep(_),p.length>0){const v=i[d].map(T=>T.presence_ref),b=p.filter(T=>v.indexOf(T.presence_ref)<0);i[d].unshift(...b)}r(d,p,_)}),this.map(c,(d,_)=>{let m=i[d];if(!m)return;const p=_.map(v=>v.presence_ref);m=m.filter(v=>p.indexOf(v.presence_ref)<0),i[d]=m,h(d,m,_),m.length===0&&delete i[d]}),i}static map(i,n){return Object.getOwnPropertyNames(i).map(r=>n(r,i[r]))}static transformState(i){return i=this.cloneDeep(i),Object.getOwnPropertyNames(i).reduce((n,r)=>{const h=i[r];return"metas"in h?n[r]=h.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[r]=h,n},{})}static cloneDeep(i){return JSON.parse(JSON.stringify(i))}onJoin(i){this.caller.onJoin=i}onLeave(i){this.caller.onLeave=i}onSync(i){this.caller.onSync=i}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Er;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Er||(Er={}));var Cr;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes"})(Cr||(Cr={}));var Or;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(Or||(Or={}));class as{constructor(i,n={config:{}},r){this.topic=i,this.params=n,this.socket=r,this.bindings={},this.state=Tt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=i.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Mn(this,Rt.join,this.params,this.timeout),this.rejoinTimer=new Po(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tt.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rt.reply,{},(h,l)=>{this._trigger(this._replyEventName(l),h)}),this.presence=new Qe(this),this.broadcastEndpointURL=To(this.socket.endPoint)+"/api/broadcast"}subscribe(i,n=this.timeout){var r,h;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:c,private:d}}=this.params;this._onError(p=>i&&i("CHANNEL_ERROR",p)),this._onClose(()=>i&&i("CLOSED"));const _={},m={broadcast:l,presence:c,postgres_changes:(h=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&h!==void 0?h:[],private:d};this.socket.accessToken&&(_.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:m},_)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:p})=>{var v;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),p===void 0){i&&i("SUBSCRIBED");return}else{const b=this.bindings.postgres_changes,T=(v=b==null?void 0:b.length)!==null&&v!==void 0?v:0,S=[];for(let P=0;P<T;P++){const k=b[P],{filter:{event:C,schema:A,table:z,filter:U}}=k,W=p&&p[P];if(W&&W.event===C&&W.schema===A&&W.table===z&&W.filter===U)S.push(Object.assign(Object.assign({},k),{id:W.id}));else{this.unsubscribe(),i&&i("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,i&&i("SUBSCRIBED");return}}).receive("error",p=>{i&&i("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{i&&i("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(i,n={}){return await this.send({type:"presence",event:"track",payload:i},n.timeout||this.timeout)}async untrack(i={}){return await this.send({type:"presence",event:"untrack"},i)}on(i,n,r){return this._on(i,n,r)}async send(i,n={}){var r,h;if(!this._canPush()&&i.type==="broadcast"){const{event:l,payload:c}=i,d={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c}]})};try{const _=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((h=_.body)===null||h===void 0?void 0:h.cancel()),_.ok?"ok":"error"}catch(_){return _.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,_;const m=this._push(i.type,i,n.timeout||this.timeout);i.type==="broadcast"&&!(!((_=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||_===void 0)&&_.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(i){this.joinPush.updatePayload(i)}unsubscribe(i=this.timeout){this.state=Tt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const h=new Mn(this,Rt.leave,{},i);h.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),h.send(),this._canPush()||h.trigger("ok",{})})}async _fetchWithTimeout(i,n,r){const h=new AbortController,l=setTimeout(()=>h.abort(),r),c=await this.socket.fetch(i,Object.assign(Object.assign({},n),{signal:h.signal}));return clearTimeout(l),c}_push(i,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let h=new Mn(this,i,n,r);return this._canPush()?h.send():(h.startTimeout(),this.pushBuffer.push(h)),h}_onMessage(i,n,r){return n}_isMember(i){return this.topic===i}_joinRef(){return this.joinPush.ref}_trigger(i,n,r){var h,l;const c=i.toLocaleLowerCase(),{close:d,error:_,leave:m,join:p}=Rt;if(r&&[d,_,m,p].indexOf(c)>=0&&r!==this._joinRef())return;let b=this._onMessage(c,n,r);if(n&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(h=this.bindings.postgres_changes)===null||h===void 0||h.filter(T=>{var S,P,k;return((S=T.filter)===null||S===void 0?void 0:S.event)==="*"||((k=(P=T.filter)===null||P===void 0?void 0:P.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===c}).map(T=>T.callback(b,r)):(l=this.bindings[c])===null||l===void 0||l.filter(T=>{var S,P,k,C,A,z;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in T){const U=T.id,W=(S=T.filter)===null||S===void 0?void 0:S.event;return U&&((P=n.ids)===null||P===void 0?void 0:P.includes(U))&&(W==="*"||(W==null?void 0:W.toLocaleLowerCase())===((k=n.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const U=(A=(C=T==null?void 0:T.filter)===null||C===void 0?void 0:C.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return U==="*"||U===((z=n==null?void 0:n.event)===null||z===void 0?void 0:z.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===c}).map(T=>{if(typeof b=="object"&&"ids"in b){const S=b.data,{schema:P,table:k,commit_timestamp:C,type:A,errors:z}=S;b=Object.assign(Object.assign({},{schema:P,table:k,commit_timestamp:C,eventType:A,new:{},old:{},errors:z}),this._getPayloadRecords(S))}T.callback(b,r)})}_isClosed(){return this.state===Tt.closed}_isJoined(){return this.state===Tt.joined}_isJoining(){return this.state===Tt.joining}_isLeaving(){return this.state===Tt.leaving}_replyEventName(i){return`chan_reply_${i}`}_on(i,n,r){const h=i.toLocaleLowerCase(),l={type:h,filter:n,callback:r};return this.bindings[h]?this.bindings[h].push(l):this.bindings[h]=[l],this}_off(i,n){const r=i.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(h=>{var l;return!(((l=h.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&as.isEqual(h.filter,n))}),this}static isEqual(i,n){if(Object.keys(i).length!==Object.keys(n).length)return!1;for(const r in i)if(i[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(i){this._on(Rt.close,{},i)}_onError(i){this._on(Rt.error,{},n=>i(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(i=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tt.joining,this.joinPush.resend(i))}_getPayloadRecords(i){const n={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(n.new=Lr(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(n.old=Lr(i.columns,i.old_record)),n}}const Ul=()=>{},Fl=typeof WebSocket<"u";class Hl{constructor(i,n){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Il,this.params={},this.timeout=bo,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Ul,this.conn=null,this.sendBuffer=[],this.serializer=new jl,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=l=>{let c;return l?c=l:typeof fetch>"u"?c=(...d)=>Ie(async()=>{const{default:_}=await Promise.resolve().then(()=>Re);return{default:_}},void 0).then(({default:_})=>_(...d)):c=fetch,(...d)=>c(...d)},this.endPoint=`${i}/${Hn.websocket}`,this.httpEndpoint=To(i),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const h=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;h&&(this.accessToken=h,this.apiKey=h),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(l,c)=>c(JSON.stringify(l)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Po(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Fl){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new ql(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ie(async()=>{const{default:i}=await import("./browser--XHHEnEz.js").then(n=>n.b);return{default:i}},[]).then(({default:i})=>{this.conn=new i(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(i,n){this.conn&&(this.conn.onclose=function(){},i?this.conn.close(i,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(i){const n=await i.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const i=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),i}log(i,n,r){this.logger(i,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ae.connecting:return _e.Connecting;case Ae.open:return _e.Open;case Ae.closing:return _e.Closing;default:return _e.Closed}}isConnected(){return this.connectionState()===_e.Open}channel(i,n={config:{}}){const r=new as(`realtime:${i}`,n,this);return this.channels.push(r),r}push(i){const{topic:n,event:r,payload:h,ref:l}=i,c=()=>{this.encode(i,d=>{var _;(_=this.conn)===null||_===void 0||_.send(d)})};this.log("push",`${n} ${r} (${l})`,h),this.isConnected()?c():this.sendBuffer.push(c)}setAuth(i){this.accessToken=i,this.channels.forEach(n=>{i&&n.updateJoinPayload({access_token:i}),n.joinedOnce&&n._isJoined()&&n._push(Rt.access_token,{access_token:i})})}_makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_leaveOpenTopic(i){let n=this.channels.find(r=>r.topic===i&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${i}"`),n.unsubscribe())}_remove(i){this.channels=this.channels.filter(n=>n._joinRef()!==i._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this._onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ml}))}_onConnMessage(i){this.decode(i.data,n=>{let{topic:r,event:h,payload:l,ref:c}=n;(c&&c===this.pendingHeartbeatRef||h===(l==null?void 0:l.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${r} ${h} ${c&&"("+c+")"||""}`,l),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(h,l,c)),this.stateChangeCallbacks.message.forEach(d=>d(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(i=>i())}_onConnClose(i){this.log("transport","close",i),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(i))}_onConnError(i){this.log("transport",i.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(i))}_triggerChanError(){this.channels.forEach(i=>i._trigger(Rt.error))}_appendParams(i,n){if(Object.keys(n).length===0)return i;const r=i.match(/\?/)?"&":"?",h=new URLSearchParams(n);return`${i}${r}${h}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_sendHeartbeat(){var i;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(i=this.conn)===null||i===void 0||i.close(Rl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ql{constructor(i,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ae.connecting,this.send=()=>{},this.url=null,this.url=i,this.close=r.close}}class hs extends Error{constructor(i){super(i),this.__isStorageError=!0,this.name="StorageError"}}function ft(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Wl extends hs{constructor(i,n){super(i),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Wn extends hs{constructor(i,n){super(i),this.name="StorageUnknownError",this.originalError=n}}var Gl=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};const ko=o=>{let i;return o?i=o:typeof fetch>"u"?i=(...n)=>Ie(async()=>{const{default:r}=await Promise.resolve().then(()=>Re);return{default:r}},void 0).then(({default:r})=>r(...n)):i=fetch,(...n)=>i(...n)},Vl=()=>Gl(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ie(()=>Promise.resolve().then(()=>Re),void 0)).Response:Response}),Gn=o=>{if(Array.isArray(o))return o.map(n=>Gn(n));if(typeof o=="function"||o!==Object(o))return o;const i={};return Object.entries(o).forEach(([n,r])=>{const h=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));i[h]=Gn(r)}),i};var pe=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};const Rn=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),Kl=(o,i,n)=>pe(void 0,void 0,void 0,function*(){const r=yield Vl();o instanceof r&&!(n!=null&&n.noResolveJson)?o.json().then(h=>{i(new Wl(Rn(h),o.status||500))}).catch(h=>{i(new Wn(Rn(h),h))}):i(new Wn(Rn(o),o))}),Jl=(o,i,n,r)=>{const h={method:o,headers:(i==null?void 0:i.headers)||{}};return o==="GET"?h:(h.headers=Object.assign({"Content-Type":"application/json"},i==null?void 0:i.headers),r&&(h.body=JSON.stringify(r)),Object.assign(Object.assign({},h),n))};function oi(o,i,n,r,h,l){return pe(this,void 0,void 0,function*(){return new Promise((c,d)=>{o(n,Jl(i,r,h,l)).then(_=>{if(!_.ok)throw _;return r!=null&&r.noResolveJson?_:_.json()}).then(_=>c(_)).catch(_=>Kl(_,d,r))})})}function Bi(o,i,n,r){return pe(this,void 0,void 0,function*(){return oi(o,"GET",i,n,r)})}function ee(o,i,n,r,h){return pe(this,void 0,void 0,function*(){return oi(o,"POST",i,r,h,n)})}function Yl(o,i,n,r,h){return pe(this,void 0,void 0,function*(){return oi(o,"PUT",i,r,h,n)})}function Xl(o,i,n,r){return pe(this,void 0,void 0,function*(){return oi(o,"HEAD",i,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Lo(o,i,n,r,h){return pe(this,void 0,void 0,function*(){return oi(o,"DELETE",i,r,h,n)})}var Pt=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};const Ql={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ar={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class tu{constructor(i,n={},r,h){this.url=i,this.headers=n,this.bucketId=r,this.fetch=ko(h)}uploadOrUpdate(i,n,r,h){return Pt(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Ar),h);let d=Object.assign(Object.assign({},this.headers),i==="POST"&&{"x-upsert":String(c.upsert)});const _=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r),_&&l.append("metadata",this.encodeMetadata(_))):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),_&&l.append("metadata",this.encodeMetadata(_))):(l=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,_&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(_)))),h!=null&&h.headers&&(d=Object.assign(Object.assign({},d),h.headers));const m=this._removeEmptyFolders(n),p=this._getFinalPath(m),v=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:i,body:l,headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{})),b=yield v.json();return v.ok?{data:{path:m,id:b.Id,fullPath:b.Key},error:null}:{data:null,error:b}}catch(l){if(ft(l))return{data:null,error:l};throw l}})}upload(i,n,r){return Pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",i,n,r)})}uploadToSignedUrl(i,n,r,h){return Pt(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(i),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let _;const m=Object.assign({upsert:Ar.upsert},h),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&r instanceof Blob?(_=new FormData,_.append("cacheControl",m.cacheControl),_.append("",r)):typeof FormData<"u"&&r instanceof FormData?(_=r,_.append("cacheControl",m.cacheControl)):(_=r,p["cache-control"]=`max-age=${m.cacheControl}`,p["content-type"]=m.contentType);const v=yield this.fetch(d.toString(),{method:"PUT",body:_,headers:p}),b=yield v.json();return v.ok?{data:{path:l,fullPath:b.Key},error:null}:{data:null,error:b}}catch(_){if(ft(_))return{data:null,error:_};throw _}})}createSignedUploadUrl(i,n){return Pt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(i);const h=Object.assign({},this.headers);n!=null&&n.upsert&&(h["x-upsert"]="true");const l=yield ee(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:h}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new hs("No token returned by API");return{data:{signedUrl:c.toString(),path:i,token:d},error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}update(i,n,r){return Pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",i,n,r)})}move(i,n,r){return Pt(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:i,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}copy(i,n,r){return Pt(this,void 0,void 0,function*(){try{return{data:{path:(yield ee(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:i,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}createSignedUrl(i,n,r){return Pt(this,void 0,void 0,function*(){try{let h=this._getFinalPath(i),l=yield ee(this.fetch,`${this.url}/object/sign/${h}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}createSignedUrls(i,n,r){return Pt(this,void 0,void 0,function*(){try{const h=yield ee(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:i},{headers:this.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:h.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}download(i,n){return Pt(this,void 0,void 0,function*(){const h=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),c=l?`?${l}`:"";try{const d=this._getFinalPath(i);return{data:yield(yield Bi(this.fetch,`${this.url}/${h}/${d}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(ft(d))return{data:null,error:d};throw d}})}info(i){return Pt(this,void 0,void 0,function*(){const n=this._getFinalPath(i);try{const r=yield Bi(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Gn(r),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}exists(i){return Pt(this,void 0,void 0,function*(){const n=this._getFinalPath(i);try{return yield Xl(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ft(r)&&r instanceof Wn){const h=r.originalError;if([400,404].includes(h==null?void 0:h.status))return{data:!1,error:r}}throw r}})}getPublicUrl(i,n){const r=this._getFinalPath(i),h=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&h.push(l);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",_=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});_!==""&&h.push(_);let m=h.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${r}${m}`)}}}remove(i){return Pt(this,void 0,void 0,function*(){try{return{data:yield Lo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:i},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}list(i,n,r){return Pt(this,void 0,void 0,function*(){try{const h=Object.assign(Object.assign(Object.assign({},Ql),n),{prefix:i||""});return{data:yield ee(this.fetch,`${this.url}/object/list/${this.bucketId}`,h,{headers:this.headers},r),error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const n=[];return i.width&&n.push(`width=${i.width}`),i.height&&n.push(`height=${i.height}`),i.resize&&n.push(`resize=${i.resize}`),i.format&&n.push(`format=${i.format}`),i.quality&&n.push(`quality=${i.quality}`),n.join("&")}}const eu="2.7.0",iu={"X-Client-Info":`storage-js/${eu}`};var Ee=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};class nu{constructor(i,n={},r){this.url=i,this.headers=Object.assign(Object.assign({},iu),n),this.fetch=ko(r)}listBuckets(){return Ee(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}getBucket(i){return Ee(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket/${i}`,{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}createBucket(i,n={public:!1}){return Ee(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/bucket`,{id:i,name:i,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}updateBucket(i,n){return Ee(this,void 0,void 0,function*(){try{return{data:yield Yl(this.fetch,`${this.url}/bucket/${i}`,{id:i,name:i,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}emptyBucket(i){return Ee(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/bucket/${i}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}deleteBucket(i){return Ee(this,void 0,void 0,function*(){try{return{data:yield Lo(this.fetch,`${this.url}/bucket/${i}`,{},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}}class su extends nu{constructor(i,n={},r){super(i,n,r)}from(i){return new tu(this.url,this.headers,i,this.fetch)}}const ru="2.45.4";let Ye="";typeof Deno<"u"?Ye="deno":typeof document<"u"?Ye="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ye="react-native":Ye="node";const ou={"X-Client-Info":`supabase-js-${Ye}/${ru}`},au={headers:ou},hu={schema:"public"},lu={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uu={};var cu=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};const du=o=>{let i;return o?i=o:typeof fetch>"u"?i=uo:i=fetch,(...n)=>i(...n)},fu=()=>typeof Headers>"u"?co:Headers,_u=(o,i,n)=>{const r=du(n),h=fu();return(l,c)=>cu(void 0,void 0,void 0,function*(){var d;const _=(d=yield i())!==null&&d!==void 0?d:o;let m=new h(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${_}`),r(l,Object.assign(Object.assign({},c),{headers:m}))})};var pu=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};function mu(o){return o.replace(/\/$/,"")}function gu(o,i){const{db:n,auth:r,realtime:h,global:l}=o,{db:c,auth:d,realtime:_,global:m}=i,p={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),r),realtime:Object.assign(Object.assign({},_),h),global:Object.assign(Object.assign({},m),l),accessToken:()=>pu(this,void 0,void 0,function*(){return""})};return o.accessToken?p.accessToken=o.accessToken:delete p.accessToken,p}const So="2.65.0",vu="http://localhost:9999",yu="supabase.auth.token",wu={"X-Client-Info":`gotrue-js/${So}`},Ir=10,Vn="X-Supabase-Api-Version",Eo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function bu(o){return Math.round(Date.now()/1e3)+o}function Pu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const i=Math.random()*16|0;return(o=="x"?i:i&3|8).toString(16)})}const Mt=()=>typeof document<"u",ce={tested:!1,writable:!1},ti=()=>{if(!Mt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ce.tested)return ce.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ce.tested=!0,ce.writable=!0}catch{ce.tested=!0,ce.writable=!1}return ce.writable};function jn(o){const i={},n=new URL(o);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((h,l)=>{i[l]=h})}catch{}return n.searchParams.forEach((r,h)=>{i[h]=r}),i}const Co=o=>{let i;return o?i=o:typeof fetch>"u"?i=(...n)=>Ie(async()=>{const{default:r}=await Promise.resolve().then(()=>Re);return{default:r}},void 0).then(({default:r})=>r(...n)):i=fetch,(...n)=>i(...n)},xu=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",Oo=async(o,i,n)=>{await o.setItem(i,JSON.stringify(n))},Ei=async(o,i)=>{const n=await o.getItem(i);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ci=async(o,i)=>{await o.removeItem(i)};function Tu(o){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,h,l,c,d,_,m,p=0;for(o=o.replace("-","+").replace("_","/");p<o.length;)c=i.indexOf(o.charAt(p++)),d=i.indexOf(o.charAt(p++)),_=i.indexOf(o.charAt(p++)),m=i.indexOf(o.charAt(p++)),r=c<<2|d>>4,h=(d&15)<<4|_>>2,l=(_&3)<<6|m,n=n+String.fromCharCode(r),_!=64&&h!=0&&(n=n+String.fromCharCode(h)),m!=64&&l!=0&&(n=n+String.fromCharCode(l));return n}class Gi{constructor(){this.promise=new Gi.promiseConstructor((i,n)=>{this.resolve=i,this.reject=n})}}Gi.promiseConstructor=Promise;function Mr(o){const i=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=o.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!i.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(Tu(r))}async function ku(o){return await new Promise(i=>{setTimeout(()=>i(null),o)})}function Lu(o,i){return new Promise((r,h)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await o(l);if(!i(l,null,c)){r(c);return}}catch(c){if(!i(l,c)){h(c);return}}})()})}function Su(o){return("0"+o.toString(16)).substr(-2)}function Eu(){const i=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let h="";for(let l=0;l<56;l++)h+=n.charAt(Math.floor(Math.random()*r));return h}return crypto.getRandomValues(i),Array.from(i,Su).join("")}async function Cu(o){const n=new TextEncoder().encode(o),r=await crypto.subtle.digest("SHA-256",n),h=new Uint8Array(r);return Array.from(h).map(l=>String.fromCharCode(l)).join("")}function Ou(o){return btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Au(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const n=await Cu(o);return Ou(n)}async function Ce(o,i,n=!1){const r=Eu();let h=r;n&&(h+="/PASSWORD_RECOVERY"),await Oo(o,`${i}-code-verifier`,h);const l=await Au(r);return[l,r===l?"plain":"s256"]}const Iu=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Mu(o){const i=o.headers.get(Vn);if(!i||!i.match(Iu))return null;try{return new Date(`${i}T00:00:00.0Z`)}catch{return null}}class ls extends Error{constructor(i,n,r){super(i),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function B(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Ru extends ls{constructor(i,n,r){super(i,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function ju(o){return B(o)&&o.name==="AuthApiError"}class Ao extends ls{constructor(i,n){super(i),this.name="AuthUnknownError",this.originalError=n}}class me extends ls{constructor(i,n,r,h){super(i,r,h),this.name=n,this.status=r}}class Qt extends me{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $u(o){return B(o)&&o.name==="AuthSessionMissingError"}class $n extends me{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Oi extends me{constructor(i){super(i,"AuthInvalidCredentialsError",400,void 0)}}class Ai extends me{constructor(i,n=null){super(i,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rr extends me{constructor(i,n=null){super(i,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kn extends me{constructor(i,n){super(i,"AuthRetryableFetchError",n,void 0)}}function zn(o){return B(o)&&o.name==="AuthRetryableFetchError"}class jr extends me{constructor(i,n,r){super(i,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var zu=function(o,i){var n={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&i.indexOf(r)<0&&(n[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,r=Object.getOwnPropertySymbols(o);h<r.length;h++)i.indexOf(r[h])<0&&Object.prototype.propertyIsEnumerable.call(o,r[h])&&(n[r[h]]=o[r[h]]);return n};const de=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),Bu=[502,503,504];async function $r(o){var i;if(!xu(o))throw new Kn(de(o),0);if(Bu.includes(o.status))throw new Kn(de(o),o.status);let n;try{n=await o.json()}catch(l){throw new Ao(de(l),l)}let r;const h=Mu(o);if(h&&h.getTime()>=Eo["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new jr(de(n),o.status,((i=n.weak_password)===null||i===void 0?void 0:i.reasons)||[]);if(r==="session_not_found")throw new Qt}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new jr(de(n),o.status,n.weak_password.reasons);throw new Ru(de(n),o.status||500,r)}const Du=(o,i,n,r)=>{const h={method:o,headers:(i==null?void 0:i.headers)||{}};return o==="GET"?h:(h.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},i==null?void 0:i.headers),h.body=JSON.stringify(r),Object.assign(Object.assign({},h),n))};async function Z(o,i,n,r){var h;const l=Object.assign({},r==null?void 0:r.headers);l[Vn]||(l[Vn]=Eo["2024-01-01"].name),r!=null&&r.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(h=r==null?void 0:r.query)!==null&&h!==void 0?h:{};r!=null&&r.redirectTo&&(c.redirect_to=r.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",_=await Nu(o,i,n+d,{headers:l,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(_):{data:Object.assign({},_),error:null}}async function Nu(o,i,n,r,h,l){const c=Du(i,r,h,l);let d;try{d=await o(n,Object.assign({},c))}catch(_){throw console.error(_),new Kn(de(_),0)}if(d.ok||await $r(d),r!=null&&r.noResolveJson)return d;try{return await d.json()}catch(_){await $r(_)}}function te(o){var i;let n=null;Hu(o)&&(n=Object.assign({},o),o.expires_at||(n.expires_at=bu(o.expires_in)));const r=(i=o.user)!==null&&i!==void 0?i:o;return{data:{session:n,user:r},error:null}}function zr(o){const i=te(o);return!i.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(i.data.weak_password=o.weak_password),i}function ie(o){var i;return{data:{user:(i=o.user)!==null&&i!==void 0?i:o},error:null}}function Zu(o){return{data:o,error:null}}function Uu(o){const{action_link:i,email_otp:n,hashed_token:r,redirect_to:h,verification_type:l}=o,c=zu(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:i,email_otp:n,hashed_token:r,redirect_to:h,verification_type:l},_=Object.assign({},c);return{data:{properties:d,user:_},error:null}}function Fu(o){return o}function Hu(o){return o.access_token&&o.refresh_token&&o.expires_in}var qu=function(o,i){var n={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&i.indexOf(r)<0&&(n[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,r=Object.getOwnPropertySymbols(o);h<r.length;h++)i.indexOf(r[h])<0&&Object.prototype.propertyIsEnumerable.call(o,r[h])&&(n[r[h]]=o[r[h]]);return n};class Wu{constructor({url:i="",headers:n={},fetch:r}){this.url=i,this.headers=n,this.fetch=Co(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(i,n="global"){try{return await Z(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:i,noResolveJson:!0}),{data:null,error:null}}catch(r){if(B(r))return{data:null,error:r};throw r}}async inviteUserByEmail(i,n={}){try{return await Z(this.fetch,"POST",`${this.url}/invite`,{body:{email:i,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ie})}catch(r){if(B(r))return{data:{user:null},error:r};throw r}}async generateLink(i){try{const{options:n}=i,r=qu(i,["options"]),h=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(h.new_email=r==null?void 0:r.newEmail,delete h.newEmail),await Z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:h,headers:this.headers,xform:Uu,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(B(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(i){try{return await Z(this.fetch,"POST",`${this.url}/admin/users`,{body:i,headers:this.headers,xform:ie})}catch(n){if(B(n))return{data:{user:null},error:n};throw n}}async listUsers(i){var n,r,h,l,c,d,_;try{const m={nextPage:null,lastPage:0,total:0},p=await Z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=i==null?void 0:i.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(l=(h=i==null?void 0:i.perPage)===null||h===void 0?void 0:h.toString())!==null&&l!==void 0?l:""},xform:Fu});if(p.error)throw p.error;const v=await p.json(),b=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,T=(_=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&_!==void 0?_:[];return T.length>0&&(T.forEach(S=>{const P=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(S.split(";")[1].split("=")[1]);m[`${k}Page`]=P}),m.total=parseInt(b)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(B(m))return{data:{users:[]},error:m};throw m}}async getUserById(i){try{return await Z(this.fetch,"GET",`${this.url}/admin/users/${i}`,{headers:this.headers,xform:ie})}catch(n){if(B(n))return{data:{user:null},error:n};throw n}}async updateUserById(i,n){try{return await Z(this.fetch,"PUT",`${this.url}/admin/users/${i}`,{body:n,headers:this.headers,xform:ie})}catch(r){if(B(r))return{data:{user:null},error:r};throw r}}async deleteUser(i,n=!1){try{return await Z(this.fetch,"DELETE",`${this.url}/admin/users/${i}`,{headers:this.headers,body:{should_soft_delete:n},xform:ie})}catch(r){if(B(r))return{data:{user:null},error:r};throw r}}async _listFactors(i){try{const{data:n,error:r}=await Z(this.fetch,"GET",`${this.url}/admin/users/${i.userId}/factors`,{headers:this.headers,xform:h=>({data:{factors:h},error:null})});return{data:n,error:r}}catch(n){if(B(n))return{data:null,error:n};throw n}}async _deleteFactor(i){try{return{data:await Z(this.fetch,"DELETE",`${this.url}/admin/users/${i.userId}/factors/${i.id}`,{headers:this.headers}),error:null}}catch(n){if(B(n))return{data:null,error:n};throw n}}}const Gu={getItem:o=>ti()?globalThis.localStorage.getItem(o):null,setItem:(o,i)=>{ti()&&globalThis.localStorage.setItem(o,i)},removeItem:o=>{ti()&&globalThis.localStorage.removeItem(o)}};function Br(o={}){return{getItem:i=>o[i]||null,setItem:(i,n)=>{o[i]=n},removeItem:i=>{delete o[i]}}}function Vu(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Oe={debug:!!(globalThis&&ti()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Io extends Error{constructor(i){super(i),this.isAcquireTimeout=!0}}class Ku extends Io{}async function Ju(o,i,n){Oe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,i);const r=new globalThis.AbortController;return i>0&&setTimeout(()=>{r.abort(),Oe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},i),await globalThis.navigator.locks.request(o,i===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async h=>{if(h){Oe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,h.name);try{return await n()}finally{Oe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,h.name)}}else{if(i===0)throw Oe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new Ku(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Oe.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}Vu();const Yu={url:vu,storageKey:yu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Je=30*1e3,Dr=3;async function Nr(o,i,n){return await n()}class ei{constructor(i){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ei.nextInstanceID,ei.nextInstanceID+=1,this.instanceID>0&&Mt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const h=Object.assign(Object.assign({},Yu),i);if(this.logDebugMessages=!!h.debug,typeof h.debug=="function"&&(this.logger=h.debug),this.persistSession=h.persistSession,this.storageKey=h.storageKey,this.autoRefreshToken=h.autoRefreshToken,this.admin=new Wu({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=Co(h.fetch),this.lock=h.lock||Nr,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,h.lock?this.lock=h.lock:Mt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Ju:this.lock=Nr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?h.storage?this.storage=h.storage:ti()?this.storage=Gu:(this.memoryStorage={},this.storage=Br(this.memoryStorage)):(this.memoryStorage={},this.storage=Br(this.memoryStorage)),Mt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...i){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${So}) ${new Date().toISOString()}`,...i),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const i=Mt()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",i),i||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:r}=await this._getSessionFromURL(i);if(r)return this._debug("#_initialize()","error detecting session from URL",r),(r==null?void 0:r.message)==="Identity is already linked"||(r==null?void 0:r.message)==="Identity is already linked to another user"?{error:r}:(await this._removeSession(),{error:r});const{session:h,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",h,"redirect type",l),await this._saveSession(h),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(i){return B(i)?{error:i}:{error:new Ao("Unexpected error during initialization",i)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(i){var n,r,h;try{const l=await Z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=i==null?void 0:i.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(h=i==null?void 0:i.options)===null||h===void 0?void 0:h.captchaToken}},xform:te}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const _=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:m,session:_},error:null}}catch(l){if(B(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(i){var n,r,h;try{let l;if("email"in i){const{email:p,password:v,options:b}=i;let T=null,S=null;this.flowType==="pkce"&&([T,S]=await Ce(this.storage,this.storageKey)),l=await Z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b==null?void 0:b.emailRedirectTo,body:{email:p,password:v,data:(n=b==null?void 0:b.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken},code_challenge:T,code_challenge_method:S},xform:te})}else if("phone"in i){const{phone:p,password:v,options:b}=i;l=await Z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(r=b==null?void 0:b.data)!==null&&r!==void 0?r:{},channel:(h=b==null?void 0:b.channel)!==null&&h!==void 0?h:"sms",gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:te})}else throw new Oi("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const _=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:m,session:_},error:null}}catch(l){if(B(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(i){try{let n;if("email"in i){const{email:l,password:c,options:d}=i;n=await Z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:zr})}else if("phone"in i){const{phone:l,password:c,options:d}=i;n=await Z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:zr})}else throw new Oi("You must provide either an email or phone number and a password");const{data:r,error:h}=n;return h?{data:{user:null,session:null},error:h}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new $n}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:h})}catch(n){if(B(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(i){var n,r,h,l;return await this._handleProviderSignIn(i.provider,{redirectTo:(n=i.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=i.options)===null||r===void 0?void 0:r.scopes,queryParams:(h=i.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:(l=i.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(i){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(i))}async _exchangeCodeForSession(i){const n=await Ei(this.storage,`${this.storageKey}-code-verifier`),[r,h]=(n??"").split("/");try{const{data:l,error:c}=await Z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:i,code_verifier:r},xform:te});if(await Ci(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new $n}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:h??null}),error:c})}catch(l){if(B(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(i){try{const{options:n,provider:r,token:h,access_token:l,nonce:c}=i,d=await Z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:h,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:te}),{data:_,error:m}=d;return m?{data:{user:null,session:null},error:m}:!_||!_.session||!_.user?{data:{user:null,session:null},error:new $n}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:_,error:m})}catch(n){if(B(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(i){var n,r,h,l,c;try{if("email"in i){const{email:d,options:_}=i;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Ce(this.storage,this.storageKey));const{error:v}=await Z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},create_user:(r=_==null?void 0:_.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:m,code_challenge_method:p},redirectTo:_==null?void 0:_.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in i){const{phone:d,options:_}=i,{data:m,error:p}=await Z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(h=_==null?void 0:_.data)!==null&&h!==void 0?h:{},create_user:(l=_==null?void 0:_.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},channel:(c=_==null?void 0:_.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:p}}throw new Oi("You must provide either an email or phone number.")}catch(d){if(B(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(i){var n,r;try{let h,l;"options"in i&&(h=(n=i.options)===null||n===void 0?void 0:n.redirectTo,l=(r=i.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:d}=await Z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},i),{gotrue_meta_security:{captcha_token:l}}),redirectTo:h,xform:te});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const _=c.session,m=c.user;return _!=null&&_.access_token&&(await this._saveSession(_),await this._notifyAllSubscribers(i.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",_)),{data:{user:m,session:_},error:null}}catch(h){if(B(h))return{data:{user:null,session:null},error:h};throw h}}async signInWithSSO(i){var n,r,h;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Ce(this.storage,this.storageKey)),await Z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in i?{provider_id:i.providerId}:null),"domain"in i?{domain:i.domain}:null),{redirect_to:(r=(n=i.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((h=i==null?void 0:i.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:i.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Zu})}catch(l){if(B(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async i=>{const{data:{session:n},error:r}=i;if(r)throw r;if(!n)throw new Qt;const{error:h}=await Z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:h}})}catch(i){if(B(i))return{data:{user:null,session:null},error:i};throw i}}async resend(i){try{const n=`${this.url}/resend`;if("email"in i){const{email:r,type:h,options:l}=i,{error:c}=await Z(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:h,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in i){const{phone:r,type:h,options:l}=i,{data:c,error:d}=await Z(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:h,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Oi("You must provide either an email or phone number and a type")}catch(n){if(B(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(i,n){this._debug("#_acquireLock","begin",i);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),h=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await h}catch{}})()),h}return await this.lock(`lock:${this.storageKey}`,i,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const h=[...this.pendingInLock];await Promise.all(h),this.pendingInLock.splice(0,h.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(i){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await i(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let i=null;const n=await Ei(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?i=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!i)return{data:{session:null},error:null};const r=i.expires_at?i.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",i.expires_at),!r){if(this.storage.isServer){let c=this.suppressGetSessionWarning;i=new Proxy(i,{get:(_,m,p)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(_,m,p))})}return{data:{session:i},error:null}}const{session:h,error:l}=await this._callRefreshToken(i.refresh_token);return l?{data:{session:null},error:l}:{data:{session:h},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(i){return i?await this._getUser(i):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(i){try{return i?await Z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:i,xform:ie}):await this._useSession(async n=>{var r,h,l;const{data:c,error:d}=n;if(d)throw d;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qt}:await Z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(h=c.session)===null||h===void 0?void 0:h.access_token)!==null&&l!==void 0?l:void 0,xform:ie})})}catch(n){if(B(n))return $u(n)&&(await this._removeSession(),await Ci(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{data:{user:null},error:n};throw n}}async updateUser(i,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(i,n))}async _updateUser(i,n={}){try{return await this._useSession(async r=>{const{data:h,error:l}=r;if(l)throw l;if(!h.session)throw new Qt;const c=h.session;let d=null,_=null;this.flowType==="pkce"&&i.email!=null&&([d,_]=await Ce(this.storage,this.storageKey));const{data:m,error:p}=await Z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},i),{code_challenge:d,code_challenge_method:_}),jwt:c.access_token,xform:ie});if(p)throw p;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(B(r))return{data:{user:null},error:r};throw r}}_decodeJWT(i){return Mr(i)}async setSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(i))}async _setSession(i){try{if(!i.access_token||!i.refresh_token)throw new Qt;const n=Date.now()/1e3;let r=n,h=!0,l=null;const c=Mr(i.access_token);if(c.exp&&(r=c.exp,h=r<=n),h){const{session:d,error:_}=await this._callRefreshToken(i.refresh_token);if(_)return{data:{user:null,session:null},error:_};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:_}=await this._getUser(i.access_token);if(_)throw _;l={access_token:i.access_token,refresh_token:i.refresh_token,user:d.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(B(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(i))}async _refreshSession(i){try{return await this._useSession(async n=>{var r;if(!i){const{data:c,error:d}=n;if(d)throw d;i=(r=c.session)!==null&&r!==void 0?r:void 0}if(!(i!=null&&i.refresh_token))throw new Qt;const{session:h,error:l}=await this._callRefreshToken(i.refresh_token);return l?{data:{user:null,session:null},error:l}:h?{data:{user:h.user,session:h},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(B(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(i){try{if(!Mt())throw new Ai("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ai("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!i)throw new Rr("Not a valid PKCE flow url.");const n=jn(window.location.href);if(i){if(!n.code)throw new Rr("No code detected.");const{data:A,error:z}=await this._exchangeCodeForSession(n.code);if(z)throw z;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:A.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new Ai(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:h,access_token:l,refresh_token:c,expires_in:d,expires_at:_,token_type:m}=n;if(!l||!d||!c||!m)throw new Ai("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(d);let b=p+v;_&&(b=parseInt(_));const T=b-p;T*1e3<=Je&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${v}s`);const S=b-v;p-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,b,p):p-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,b,p);const{data:P,error:k}=await this._getUser(l);if(k)throw k;const C={provider_token:r,provider_refresh_token:h,access_token:l,expires_in:v,expires_at:b,refresh_token:c,token_type:m,user:P.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:C,redirectType:n.type},error:null}}catch(n){if(B(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const i=jn(window.location.href);return!!(Mt()&&(i.access_token||i.error_description))}async _isPKCEFlow(){const i=jn(window.location.href),n=await Ei(this.storage,`${this.storageKey}-code-verifier`);return!!(i.code&&n)}async signOut(i={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(i))}async _signOut({scope:i}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:h,error:l}=n;if(l)return{error:l};const c=(r=h.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:d}=await this.admin.signOut(c,i);if(d&&!(ju(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return i!=="others"&&(await this._removeSession(),await Ci(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(i){const n=Pu(),r={id:n,callback:i,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(i){return await this._useSession(async n=>{var r,h;try{const{data:{session:l},error:c}=n;if(c)throw c;await((r=this.stateChangeEmitters.get(i))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",i,"session",l)}catch(l){await((h=this.stateChangeEmitters.get(i))===null||h===void 0?void 0:h.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",i,"error",l),console.error(l)}})}async resetPasswordForEmail(i,n={}){let r=null,h=null;this.flowType==="pkce"&&([r,h]=await Ce(this.storage,this.storageKey,!0));try{return await Z(this.fetch,"POST",`${this.url}/recover`,{body:{email:i,code_challenge:r,code_challenge_method:h,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(B(l))return{data:null,error:l};throw l}}async getUserIdentities(){var i;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(i=n.user.identities)!==null&&i!==void 0?i:[]},error:null}}catch(n){if(B(n))return{data:null,error:n};throw n}}async linkIdentity(i){var n;try{const{data:r,error:h}=await this._useSession(async l=>{var c,d,_,m,p;const{data:v,error:b}=l;if(b)throw b;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,i.provider,{redirectTo:(c=i.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=i.options)===null||d===void 0?void 0:d.scopes,queryParams:(_=i.options)===null||_===void 0?void 0:_.queryParams,skipBrowserRedirect:!0});return await Z(this.fetch,"GET",T,{headers:this.headers,jwt:(p=(m=v.session)===null||m===void 0?void 0:m.access_token)!==null&&p!==void 0?p:void 0})});if(h)throw h;return Mt()&&!(!((n=i.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:i.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(B(r))return{data:{provider:i.provider,url:null},error:r};throw r}}async unlinkIdentity(i){try{return await this._useSession(async n=>{var r,h;const{data:l,error:c}=n;if(c)throw c;return await Z(this.fetch,"DELETE",`${this.url}/user/identities/${i.identity_id}`,{headers:this.headers,jwt:(h=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&h!==void 0?h:void 0})})}catch(n){if(B(n))return{data:null,error:n};throw n}}async _refreshAccessToken(i){const n=`#_refreshAccessToken(${i.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Lu(async h=>(h>0&&await ku(200*Math.pow(2,h-1)),this._debug(n,"refreshing attempt",h),await Z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:i},headers:this.headers,xform:te})),(h,l)=>{const c=200*Math.pow(2,h);return l&&zn(l)&&Date.now()+c-r<Je})}catch(r){if(this._debug(n,"error",r),B(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(i){return typeof i=="object"&&i!==null&&"access_token"in i&&"refresh_token"in i&&"expires_at"in i}async _handleProviderSignIn(i,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,i,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",i,"options",n,"url",r),Mt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:i,url:r},error:null}}async _recoverAndRefresh(){var i;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Ei(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const h=Math.round(Date.now()/1e3),l=((i=r.expires_at)!==null&&i!==void 0?i:1/0)<h+Ir;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${Ir}s`),l){if(this.autoRefreshToken&&r.refresh_token){const{error:c}=await this._callRefreshToken(r.refresh_token);c&&(console.error(c),zn(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(i){var n,r;if(!i)throw new Qt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const h=`#_callRefreshToken(${i.substring(0,5)}...)`;this._debug(h,"begin");try{this.refreshingDeferred=new Gi;const{data:l,error:c}=await this._refreshAccessToken(i);if(c)throw c;if(!l.session)throw new Qt;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(h,"error",l),B(l)){const c={session:null,error:l};return zn(l)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(h,"end")}}async _notifyAllSubscribers(i,n,r=!0){const h=`#_notifyAllSubscribers(${i})`;this._debug(h,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:i,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(i,n)}catch(_){l.push(_)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(h,"end")}}async _saveSession(i){this._debug("#_saveSession()",i),this.suppressGetSessionWarning=!0,await Oo(this.storage,this.storageKey,i)}async _removeSession(){this._debug("#_removeSession()"),await Ci(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const i=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{i&&Mt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",i)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const i=setInterval(()=>this._autoRefreshTokenTick(),Je);this.autoRefreshTicker=i,i&&typeof i=="object"&&typeof i.unref=="function"?i.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(i),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const i=this.autoRefreshTicker;this.autoRefreshTicker=null,i&&clearInterval(i)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const i=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const h=Math.floor((r.expires_at*1e3-i)/Je);this._debug("#_autoRefreshTokenTick()",`access token expires in ${h} ticks, a tick lasts ${Je}ms, refresh threshold is ${Dr} ticks`),h<=Dr&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(i){if(i.isAcquireTimeout||i instanceof Io)this._debug("auto refresh token tick lock not available");else throw i}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Mt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(i){console.error("_handleVisibilityChange",i)}}async _onVisibilityChanged(i){const n=`#_onVisibilityChanged(${i})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),i||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(i,n,r){const h=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&h.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&h.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await Ce(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});h.push(d.toString())}if(r!=null&&r.queryParams){const l=new URLSearchParams(r.queryParams);h.push(l.toString())}return r!=null&&r.skipBrowserRedirect&&h.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${i}?${h.join("&")}`}async _unenroll(i){try{return await this._useSession(async n=>{var r;const{data:h,error:l}=n;return l?{data:null,error:l}:await Z(this.fetch,"DELETE",`${this.url}/factors/${i.factorId}`,{headers:this.headers,jwt:(r=h==null?void 0:h.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(B(n))return{data:null,error:n};throw n}}async _enroll(i){try{return await this._useSession(async n=>{var r,h;const{data:l,error:c}=n;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:i.friendlyName,factor_type:i.factorType},i.factorType==="phone"?{phone:i.phone}:{issuer:i.issuer}),{data:_,error:m}=await Z(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(r=l==null?void 0:l.session)===null||r===void 0?void 0:r.access_token});return m?{data:null,error:m}:(i.factorType==="phone"&&delete _.totp,i.factorType==="totp"&&(!((h=_==null?void 0:_.totp)===null||h===void 0)&&h.qr_code)&&(_.totp.qr_code=`data:image/svg+xml;utf-8,${_.totp.qr_code}`),{data:_,error:null})})}catch(n){if(B(n))return{data:null,error:n};throw n}}async _verify(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:h,error:l}=n;if(l)return{data:null,error:l};const{data:c,error:d}=await Z(this.fetch,"POST",`${this.url}/factors/${i.factorId}/verify`,{body:{code:i.code,challenge_id:i.challengeId},headers:this.headers,jwt:(r=h==null?void 0:h.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(n){if(B(n))return{data:null,error:n};throw n}})}async _challenge(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:h,error:l}=n;return l?{data:null,error:l}:await Z(this.fetch,"POST",`${this.url}/factors/${i.factorId}/challenge`,{body:{channel:i.channel},headers:this.headers,jwt:(r=h==null?void 0:h.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(B(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(i){const{data:n,error:r}=await this._challenge({factorId:i.factorId});return r?{data:null,error:r}:await this._verify({factorId:i.factorId,challengeId:n.id,code:i.code})}async _listFactors(){const{data:{user:i},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(i==null?void 0:i.factors)||[],h=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:h,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async i=>{var n,r;const{data:{session:h},error:l}=i;if(l)return{data:null,error:l};if(!h)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const c=this._decodeJWT(h.access_token);let d=null;c.aal&&(d=c.aal);let _=d;((r=(n=h.user.factors)===null||n===void 0?void 0:n.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(_="aal2");const p=c.amr||[];return{data:{currentLevel:d,nextLevel:_,currentAuthenticationMethods:p},error:null}}))}}ei.nextInstanceID=0;const Xu=ei;class Qu extends Xu{constructor(i){super(i)}}var tc=function(o,i,n,r){function h(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{m(r.next(p))}catch(v){c(v)}}function _(p){try{m(r.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):h(p.value).then(d,_)}m((r=r.apply(o,i||[])).next())})};class ec{constructor(i,n,r){var h,l,c;if(this.supabaseUrl=i,this.supabaseKey=n,!i)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const d=mu(i);this.realtimeUrl=`${d}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${d}/auth/v1`,this.storageUrl=`${d}/storage/v1`,this.functionsUrl=`${d}/functions/v1`;const _=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,m={db:hu,realtime:uu,auth:Object.assign(Object.assign({},lu),{storageKey:_}),global:au},p=gu(r??{},m);this.storageKey=(h=p.auth.storageKey)!==null&&h!==void 0?h:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(v,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=_u(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},p.realtime)),this.rest=new Ol(`${d}/rest/v1`,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),p.accessToken||this._listenForAuthEvents()}get functions(){return new sl(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new su(this.storageUrl,this.headers,this.fetch)}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,n={},r={}){return this.rest.rpc(i,n,r)}channel(i,n={config:{}}){return this.realtime.channel(i,n)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var i,n;return tc(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(i=r.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:n,detectSessionInUrl:r,storage:h,storageKey:l,flowType:c,lock:d,debug:_},m,p){var v;const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qu({url:this.authUrl,headers:Object.assign(Object.assign({},b),m),storageKey:l,autoRefreshToken:i,persistSession:n,detectSessionInUrl:r,storage:h,flowType:c,lock:d,debug:_,fetch:p,hasCustomAuthorizationHeader:(v="Authorization"in this.headers)!==null&&v!==void 0?v:!1})}_initRealtimeClient(i){return new Hl(this.realtimeUrl,Object.assign(Object.assign({},i),{params:Object.assign({apikey:this.supabaseKey},i==null?void 0:i.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(i,n,r){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):i==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ic=(o,i,n)=>new ec(o,i,n),nc="https://veclcridxyeqhbenssvk.supabase.co",sc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZlY2xjcmlkeHllcWhiZW5zc3ZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjY1MDUzMTksImV4cCI6MjA0MjA4MTMxOX0.kMSSWaPaVNE_dhmGLGCXy11cH1oi4TM64XQAc2PS8tQ",ii=ic(nc,sc);var rc=Ot('<div class=glass-container4><div class=prijava-container><form><h2>Prijava</h2><input type=text placeholder="Korisnicko ime"required><input type=email placeholder=Email required><input type=password placeholder=Lozinka required><button type=submit>Prijavite se'),oc=Ot("<p>");const ac=()=>{const[o,i]=ot(""),[n,r]=ot(""),[h,l]=ot(""),[c,d]=ot(""),_=ns(),m=async p=>{p.preventDefault();try{const{data:v,error:b}=await ii.from("users").select("*").eq("email",n()).eq("password",h()).eq("name",o()).single();if(b||!v){d("Neispravni podaci za prijavu. Pokuajte ponovo.");return}_("/home",{state:{name:v.name}})}catch(v){d("Greka: "+v.message)}};return(()=>{var p=rc(),v=p.firstChild,b=v.firstChild,T=b.firstChild,S=T.nextSibling,P=S.nextSibling,k=P.nextSibling;return k.nextSibling,b.addEventListener("submit",m),S.$$input=C=>i(C.target.value),P.$$input=C=>r(C.target.value),k.$$input=C=>l(C.target.value),gt(b,(()=>{var C=at(()=>!!c());return()=>C()&&(()=>{var A=oc();return A.style.setProperty("color","red"),gt(A,c),A})()})(),null),p})()};Zi(["input"]);var hc=Ot("<header class=dashboard-header><h1>Pocetna</h1><div class=header-buttons> <button class=info-button>Informacije</button><button class=logout-button>Odjavi se"),lc=Ot("<h3>Dobrodosli, <!>!");const Mo=({name:o,showWelcome:i=!0})=>{const n=ns(),r=async()=>{const{error:h}=await ii.auth.signOut();h?console.error("Greka pri odjavi:",h.message):n("/login")};return(()=>{var h=hc(),l=h.firstChild,c=l.nextSibling,d=c.firstChild,_=d.nextSibling,m=_.nextSibling;return l.$$click=()=>n("/home"),gt(c,i&&(()=>{var p=lc(),v=p.firstChild,b=v.nextSibling;return b.nextSibling,gt(p,o,b),p})(),d),_.$$click=()=>n("/info"),m.$$click=r,h})()};Zi(["click"]);var Jn={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(o,i){(function(n,r){r(i)})(kt,function(n){var r="1.9.4";function h(t){var e,s,a,u;for(s=1,a=arguments.length;s<a;s++){u=arguments[s];for(e in u)t[e]=u[e]}return t}var l=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function c(t,e){var s=Array.prototype.slice;if(t.bind)return t.bind.apply(t,s.call(arguments,1));var a=s.call(arguments,2);return function(){return t.apply(e,a.length?a.concat(s.call(arguments)):arguments)}}var d=0;function _(t){return"_leaflet_id"in t||(t._leaflet_id=++d),t._leaflet_id}function m(t,e,s){var a,u,f,g;return g=function(){a=!1,u&&(f.apply(s,u),u=!1)},f=function(){a?u=arguments:(t.apply(s,arguments),setTimeout(g,e),a=!0)},f}function p(t,e,s){var a=e[1],u=e[0],f=a-u;return t===a&&s?t:((t-u)%f+f)%f+u}function v(){return!1}function b(t,e){if(e===!1)return t;var s=Math.pow(10,e===void 0?6:e);return Math.round(t*s)/s}function T(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function S(t){return T(t).split(/\s+/)}function P(t,e){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?l(t.options):{});for(var s in e)t.options[s]=e[s];return t.options}function k(t,e,s){var a=[];for(var u in t)a.push(encodeURIComponent(s?u.toUpperCase():u)+"="+encodeURIComponent(t[u]));return(!e||e.indexOf("?")===-1?"?":"&")+a.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function A(t,e){return t.replace(C,function(s,a){var u=e[a];if(u===void 0)throw new Error("No value provided for variable "+s);return typeof u=="function"&&(u=u(e)),u})}var z=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function U(t,e){for(var s=0;s<t.length;s++)if(t[s]===e)return s;return-1}var W="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ut(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var Nt=0;function Zt(t){var e=+new Date,s=Math.max(0,16-(e-Nt));return Nt=e+s,window.setTimeout(t,s)}var re=window.requestAnimationFrame||ut("RequestAnimationFrame")||Zt,mt=window.cancelAnimationFrame||ut("CancelAnimationFrame")||ut("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function Q(t,e,s){if(s&&re===Zt)t.call(e);else return re.call(window,c(t,e))}function wt(t){t&&mt.call(window,t)}var V={__proto__:null,extend:h,create:l,bind:c,get lastId(){return d},stamp:_,throttle:m,wrapNum:p,falseFn:v,formatNum:b,trim:T,splitWords:S,setOptions:P,getParamString:k,template:A,isArray:z,indexOf:U,emptyImageUrl:W,requestFn:re,cancelFn:mt,requestAnimFrame:Q,cancelAnimFrame:wt};function N(){}N.extend=function(t){var e=function(){P(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=e.__super__=this.prototype,a=l(s);a.constructor=e,e.prototype=a;for(var u in this)Object.prototype.hasOwnProperty.call(this,u)&&u!=="prototype"&&u!=="__super__"&&(e[u]=this[u]);return t.statics&&h(e,t.statics),t.includes&&(xt(t.includes),h.apply(null,[a].concat(t.includes))),h(a,t),delete a.statics,delete a.includes,a.options&&(a.options=s.options?l(s.options):{},h(a.options,t.options)),a._initHooks=[],a.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var f=0,g=a._initHooks.length;f<g;f++)a._initHooks[f].call(this)}},e},N.include=function(t){var e=this.prototype.options;return h(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},N.mergeOptions=function(t){return h(this.prototype.options,t),this},N.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),s=typeof t=="function"?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(s),this};function xt(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=z(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ct={on:function(t,e,s){if(typeof t=="object")for(var a in t)this._on(a,t[a],e);else{t=S(t);for(var u=0,f=t.length;u<f;u++)this._on(t[u],e,s)}return this},off:function(t,e,s){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var a in t)this._off(a,t[a],e);else{t=S(t);for(var u=arguments.length===1,f=0,g=t.length;f<g;f++)u?this._off(t[f]):this._off(t[f],e,s)}return this},_on:function(t,e,s,a){if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}if(this._listens(t,e,s)===!1){s===this&&(s=void 0);var u={fn:e,ctx:s};a&&(u.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(u)}},_off:function(t,e,s){var a,u,f;if(this._events&&(a=this._events[t],!!a)){if(arguments.length===1){if(this._firingCount)for(u=0,f=a.length;u<f;u++)a[u].fn=v;delete this._events[t];return}if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}var g=this._listens(t,e,s);if(g!==!1){var y=a[g];this._firingCount&&(y.fn=v,this._events[t]=a=a.slice()),a.splice(g,1)}}},fire:function(t,e,s){if(!this.listens(t,s))return this;var a=h({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var u=this._events[t];if(u){this._firingCount=this._firingCount+1||1;for(var f=0,g=u.length;f<g;f++){var y=u[f],w=y.fn;y.once&&this.off(t,w,y.ctx),w.call(y.ctx||this,a)}this._firingCount--}}return s&&this._propagateEvent(a),this},listens:function(t,e,s,a){typeof t!="string"&&console.warn('"string" type argument expected');var u=e;typeof e!="function"&&(a=!!e,u=void 0,s=void 0);var f=this._events&&this._events[t];if(f&&f.length&&this._listens(t,u,s)!==!1)return!0;if(a){for(var g in this._eventParents)if(this._eventParents[g].listens(t,e,s,a))return!0}return!1},_listens:function(t,e,s){if(!this._events)return!1;var a=this._events[t]||[];if(!e)return!!a.length;s===this&&(s=void 0);for(var u=0,f=a.length;u<f;u++)if(a[u].fn===e&&a[u].ctx===s)return u;return!1},once:function(t,e,s){if(typeof t=="object")for(var a in t)this._on(a,t[a],e,!0);else{t=S(t);for(var u=0,f=t.length;u<f;u++)this._on(t[u],e,s,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[_(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[_(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,h({layer:t.target,propagatedFrom:t.target},t),!0)}};ct.addEventListener=ct.on,ct.removeEventListener=ct.clearAllEventListeners=ct.off,ct.addOneTimeEventListener=ct.once,ct.fireEvent=ct.fire,ct.hasEventListeners=ct.listens;var Ut=N.extend(ct);function M(t,e,s){this.x=s?Math.round(t):t,this.y=s?Math.round(e):e}var ge=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};M.prototype={clone:function(){return new M(this.x,this.y)},add:function(t){return this.clone()._add(I(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(I(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new M(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new M(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ge(this.x),this.y=ge(this.y),this},distanceTo:function(t){t=I(t);var e=t.x-this.x,s=t.y-this.y;return Math.sqrt(e*e+s*s)},equals:function(t){return t=I(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=I(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function I(t,e,s){return t instanceof M?t:z(t)?new M(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new M(t.x,t.y):new M(t,e,s)}function tt(t,e){if(t)for(var s=e?[t,e]:t,a=0,u=s.length;a<u;a++)this.extend(s[a])}tt.prototype={extend:function(t){var e,s;if(!t)return this;if(t instanceof M||typeof t[0]=="number"||"x"in t)e=s=I(t);else if(t=lt(t),e=t.min,s=t.max,!e||!s)return this;return!this.min&&!this.max?(this.min=e.clone(),this.max=s.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(s.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(s.y,this.max.y)),this},getCenter:function(t){return I((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return I(this.min.x,this.max.y)},getTopRight:function(){return I(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,s;return typeof t[0]=="number"||t instanceof M?t=I(t):t=lt(t),t instanceof tt?(e=t.min,s=t.max):e=s=t,e.x>=this.min.x&&s.x<=this.max.x&&e.y>=this.min.y&&s.y<=this.max.y},intersects:function(t){t=lt(t);var e=this.min,s=this.max,a=t.min,u=t.max,f=u.x>=e.x&&a.x<=s.x,g=u.y>=e.y&&a.y<=s.y;return f&&g},overlaps:function(t){t=lt(t);var e=this.min,s=this.max,a=t.min,u=t.max,f=u.x>e.x&&a.x<s.x,g=u.y>e.y&&a.y<s.y;return f&&g},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var e=this.min,s=this.max,a=Math.abs(e.x-s.x)*t,u=Math.abs(e.y-s.y)*t;return lt(I(e.x-a,e.y-u),I(s.x+a,s.y+u))},equals:function(t){return t?(t=lt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function lt(t,e){return!t||t instanceof tt?t:new tt(t,e)}function _t(t,e){if(t)for(var s=e?[t,e]:t,a=0,u=s.length;a<u;a++)this.extend(s[a])}_t.prototype={extend:function(t){var e=this._southWest,s=this._northEast,a,u;if(t instanceof K)a=t,u=t;else if(t instanceof _t){if(a=t._southWest,u=t._northEast,!a||!u)return this}else return t?this.extend(F(t)||nt(t)):this;return!e&&!s?(this._southWest=new K(a.lat,a.lng),this._northEast=new K(u.lat,u.lng)):(e.lat=Math.min(a.lat,e.lat),e.lng=Math.min(a.lng,e.lng),s.lat=Math.max(u.lat,s.lat),s.lng=Math.max(u.lng,s.lng)),this},pad:function(t){var e=this._southWest,s=this._northEast,a=Math.abs(e.lat-s.lat)*t,u=Math.abs(e.lng-s.lng)*t;return new _t(new K(e.lat-a,e.lng-u),new K(s.lat+a,s.lng+u))},getCenter:function(){return new K((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new K(this.getNorth(),this.getWest())},getSouthEast:function(){return new K(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof K||"lat"in t?t=F(t):t=nt(t);var e=this._southWest,s=this._northEast,a,u;return t instanceof _t?(a=t.getSouthWest(),u=t.getNorthEast()):a=u=t,a.lat>=e.lat&&u.lat<=s.lat&&a.lng>=e.lng&&u.lng<=s.lng},intersects:function(t){t=nt(t);var e=this._southWest,s=this._northEast,a=t.getSouthWest(),u=t.getNorthEast(),f=u.lat>=e.lat&&a.lat<=s.lat,g=u.lng>=e.lng&&a.lng<=s.lng;return f&&g},overlaps:function(t){t=nt(t);var e=this._southWest,s=this._northEast,a=t.getSouthWest(),u=t.getNorthEast(),f=u.lat>e.lat&&a.lat<s.lat,g=u.lng>e.lng&&a.lng<s.lng;return f&&g},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return t?(t=nt(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function nt(t,e){return t instanceof _t?t:new _t(t,e)}function K(t,e,s){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,s!==void 0&&(this.alt=+s)}K.prototype={equals:function(t,e){if(!t)return!1;t=F(t);var s=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return s<=(e===void 0?1e-9:e)},toString:function(t){return"LatLng("+b(this.lat,t)+", "+b(this.lng,t)+")"},distanceTo:function(t){return Jt.distance(this,F(t))},wrap:function(){return Jt.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,s=e/Math.cos(Math.PI/180*this.lat);return nt([this.lat-e,this.lng-s],[this.lat+e,this.lng+s])},clone:function(){return new K(this.lat,this.lng,this.alt)}};function F(t,e,s){return t instanceof K?t:z(t)&&typeof t[0]!="object"?t.length===3?new K(t[0],t[1],t[2]):t.length===2?new K(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new K(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===void 0?null:new K(t,e,s)}var Ft={latLngToPoint:function(t,e){var s=this.projection.project(t),a=this.scale(e);return this.transformation._transform(s,a)},pointToLatLng:function(t,e){var s=this.scale(e),a=this.transformation.untransform(t,s);return this.projection.unproject(a)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,s=this.scale(t),a=this.transformation.transform(e.min,s),u=this.transformation.transform(e.max,s);return new tt(a,u)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,s=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,a=t.alt;return new K(s,e,a)},wrapLatLngBounds:function(t){var e=t.getCenter(),s=this.wrapLatLng(e),a=e.lat-s.lat,u=e.lng-s.lng;if(a===0&&u===0)return t;var f=t.getSouthWest(),g=t.getNorthEast(),y=new K(f.lat-a,f.lng-u),w=new K(g.lat-a,g.lng-u);return new _t(y,w)}},Jt=h({},Ft,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var s=Math.PI/180,a=t.lat*s,u=e.lat*s,f=Math.sin((e.lat-t.lat)*s/2),g=Math.sin((e.lng-t.lng)*s/2),y=f*f+Math.cos(a)*Math.cos(u)*g*g,w=2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y));return this.R*w}}),us=6378137,Vi={R:us,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,s=this.MAX_LATITUDE,a=Math.max(Math.min(s,t.lat),-s),u=Math.sin(a*e);return new M(this.R*t.lng*e,this.R*Math.log((1+u)/(1-u))/2)},unproject:function(t){var e=180/Math.PI;return new K((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=us*Math.PI;return new tt([-t,-t],[t,t])}()};function Ki(t,e,s,a){if(z(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=e,this._c=s,this._d=a}Ki.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new M((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};function je(t,e,s,a){return new Ki(t,e,s,a)}var Ji=h({},Jt,{code:"EPSG:3857",projection:Vi,transformation:function(){var t=.5/(Math.PI*Vi.R);return je(t,.5,-t,.5)}()}),Ro=h({},Ji,{code:"EPSG:900913"});function cs(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ds(t,e){var s="",a,u,f,g,y,w;for(a=0,f=t.length;a<f;a++){for(y=t[a],u=0,g=y.length;u<g;u++)w=y[u],s+=(u?"L":"M")+w.x+" "+w.y;s+=e?O.svg?"z":"x":""}return s||"M0 0"}var Yi=document.documentElement.style,ai="ActiveXObject"in window,jo=ai&&!document.addEventListener,fs="msLaunchUri"in navigator&&!("documentMode"in document),Xi=$t("webkit"),_s=$t("android"),ps=$t("android 2")||$t("android 3"),$o=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),zo=_s&&$t("Google")&&$o<537&&!("AudioNode"in window),Qi=!!window.opera,ms=!fs&&$t("chrome"),gs=$t("gecko")&&!Xi&&!Qi&&!ai,Bo=!ms&&$t("safari"),vs=$t("phantom"),ys="OTransition"in Yi,Do=navigator.platform.indexOf("Win")===0,ws=ai&&"transition"in Yi,tn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ps,bs="MozPerspective"in Yi,No=!window.L_DISABLE_3D&&(ws||tn||bs)&&!ys&&!vs,$e=typeof orientation<"u"||$t("mobile"),Zo=$e&&Xi,Uo=$e&&tn,Ps=!window.PointerEvent&&window.MSPointerEvent,xs=!!(window.PointerEvent||Ps),Ts="ontouchstart"in window||!!window.TouchEvent,Fo=!window.L_NO_TOUCH&&(Ts||xs),Ho=$e&&Qi,qo=$e&&gs,Wo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Go=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",v,e),window.removeEventListener("testPassiveEventSupport",v,e)}catch{}return t}(),Vo=function(){return!!document.createElement("canvas").getContext}(),en=!!(document.createElementNS&&cs("svg").createSVGRect),Ko=!!en&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Jo=!en&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&typeof e.adj=="object"}catch{return!1}}(),Yo=navigator.platform.indexOf("Mac")===0,Xo=navigator.platform.indexOf("Linux")===0;function $t(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var O={ie:ai,ielt9:jo,edge:fs,webkit:Xi,android:_s,android23:ps,androidStock:zo,opera:Qi,chrome:ms,gecko:gs,safari:Bo,phantom:vs,opera12:ys,win:Do,ie3d:ws,webkit3d:tn,gecko3d:bs,any3d:No,mobile:$e,mobileWebkit:Zo,mobileWebkit3d:Uo,msPointer:Ps,pointer:xs,touch:Fo,touchNative:Ts,mobileOpera:Ho,mobileGecko:qo,retina:Wo,passiveEvents:Go,canvas:Vo,svg:en,vml:Jo,inlineSvg:Ko,mac:Yo,linux:Xo},ks=O.msPointer?"MSPointerDown":"pointerdown",Ls=O.msPointer?"MSPointerMove":"pointermove",Ss=O.msPointer?"MSPointerUp":"pointerup",Es=O.msPointer?"MSPointerCancel":"pointercancel",nn={touchstart:ks,touchmove:Ls,touchend:Ss,touchcancel:Es},Cs={touchstart:sa,touchmove:hi,touchend:hi,touchcancel:hi},ve={},Os=!1;function Qo(t,e,s){return e==="touchstart"&&na(),Cs[e]?(s=Cs[e].bind(this,s),t.addEventListener(nn[e],s,!1),s):(console.warn("wrong event specified:",e),v)}function ta(t,e,s){if(!nn[e]){console.warn("wrong event specified:",e);return}t.removeEventListener(nn[e],s,!1)}function ea(t){ve[t.pointerId]=t}function ia(t){ve[t.pointerId]&&(ve[t.pointerId]=t)}function As(t){delete ve[t.pointerId]}function na(){Os||(document.addEventListener(ks,ea,!0),document.addEventListener(Ls,ia,!0),document.addEventListener(Ss,As,!0),document.addEventListener(Es,As,!0),Os=!0)}function hi(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){e.touches=[];for(var s in ve)e.touches.push(ve[s]);e.changedTouches=[e],t(e)}}function sa(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&pt(e),hi(t,e)}function ra(t){var e={},s,a;for(a in t)s=t[a],e[a]=s&&s.bind?s.bind(t):s;return t=e,e.type="dblclick",e.detail=2,e.isTrusted=!1,e._simulated=!0,e}var oa=200;function aa(t,e){t.addEventListener("dblclick",e);var s=0,a;function u(f){if(f.detail!==1){a=f.detail;return}if(!(f.pointerType==="mouse"||f.sourceCapabilities&&!f.sourceCapabilities.firesTouchEvents)){var g=$s(f);if(!(g.some(function(w){return w instanceof HTMLLabelElement&&w.attributes.for})&&!g.some(function(w){return w instanceof HTMLInputElement||w instanceof HTMLSelectElement}))){var y=Date.now();y-s<=oa?(a++,a===2&&e(ra(f))):a=1,s=y}}}return t.addEventListener("click",u),{dblclick:e,simDblclick:u}}function ha(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var sn=ci(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ze=ci(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Is=ze==="webkitTransition"||ze==="OTransition"?ze+"End":"transitionend";function Ms(t){return typeof t=="string"?document.getElementById(t):t}function Be(t,e){var s=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!s||s==="auto")&&document.defaultView){var a=document.defaultView.getComputedStyle(t,null);s=a?a[e]:null}return s==="auto"?null:s}function q(t,e,s){var a=document.createElement(t);return a.className=e||"",s&&s.appendChild(a),a}function et(t){var e=t.parentNode;e&&e.removeChild(t)}function li(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ye(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function we(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function rn(t,e){if(t.classList!==void 0)return t.classList.contains(e);var s=ui(t);return s.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(s)}function $(t,e){if(t.classList!==void 0)for(var s=S(e),a=0,u=s.length;a<u;a++)t.classList.add(s[a]);else if(!rn(t,e)){var f=ui(t);on(t,(f?f+" ":"")+e)}}function it(t,e){t.classList!==void 0?t.classList.remove(e):on(t,T((" "+ui(t)+" ").replace(" "+e+" "," ")))}function on(t,e){t.className.baseVal===void 0?t.className=e:t.className.baseVal=e}function ui(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function Lt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&la(t,e)}function la(t,e){var s=!1,a="DXImageTransform.Microsoft.Alpha";try{s=t.filters.item(a)}catch{if(e===1)return}e=Math.round(e*100),s?(s.Enabled=e!==100,s.Opacity=e):t.style.filter+=" progid:"+a+"(opacity="+e+")"}function ci(t){for(var e=document.documentElement.style,s=0;s<t.length;s++)if(t[s]in e)return t[s];return!1}function oe(t,e,s){var a=e||new M(0,0);t.style[sn]=(O.ie3d?"translate("+a.x+"px,"+a.y+"px)":"translate3d("+a.x+"px,"+a.y+"px,0)")+(s?" scale("+s+")":"")}function st(t,e){t._leaflet_pos=e,O.any3d?oe(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ae(t){return t._leaflet_pos||new M(0,0)}var De,Ne,an;if("onselectstart"in document)De=function(){j(window,"selectstart",pt)},Ne=function(){J(window,"selectstart",pt)};else{var Ze=ci(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);De=function(){if(Ze){var t=document.documentElement.style;an=t[Ze],t[Ze]="none"}},Ne=function(){Ze&&(document.documentElement.style[Ze]=an,an=void 0)}}function hn(){j(window,"dragstart",pt)}function ln(){J(window,"dragstart",pt)}var di,un;function cn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(fi(),di=t,un=t.style.outlineStyle,t.style.outlineStyle="none",j(window,"keydown",fi))}function fi(){di&&(di.style.outlineStyle=un,di=void 0,un=void 0,J(window,"keydown",fi))}function Rs(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function dn(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var ua={__proto__:null,TRANSFORM:sn,TRANSITION:ze,TRANSITION_END:Is,get:Ms,getStyle:Be,create:q,remove:et,empty:li,toFront:ye,toBack:we,hasClass:rn,addClass:$,removeClass:it,setClass:on,getClass:ui,setOpacity:Lt,testProp:ci,setTransform:oe,setPosition:st,getPosition:ae,get disableTextSelection(){return De},get enableTextSelection(){return Ne},disableImageDrag:hn,enableImageDrag:ln,preventOutline:cn,restoreOutline:fi,getSizedParentNode:Rs,getScale:dn};function j(t,e,s,a){if(e&&typeof e=="object")for(var u in e)_n(t,u,e[u],s);else{e=S(e);for(var f=0,g=e.length;f<g;f++)_n(t,e[f],s,a)}return this}var zt="_leaflet_events";function J(t,e,s,a){if(arguments.length===1)js(t),delete t[zt];else if(e&&typeof e=="object")for(var u in e)pn(t,u,e[u],s);else if(e=S(e),arguments.length===2)js(t,function(y){return U(e,y)!==-1});else for(var f=0,g=e.length;f<g;f++)pn(t,e[f],s,a);return this}function js(t,e){for(var s in t[zt]){var a=s.split(/\d/)[0];(!e||e(a))&&pn(t,a,null,null,s)}}var fn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function _n(t,e,s,a){var u=e+_(s)+(a?"_"+_(a):"");if(t[zt]&&t[zt][u])return this;var f=function(y){return s.call(a||t,y||window.event)},g=f;!O.touchNative&&O.pointer&&e.indexOf("touch")===0?f=Qo(t,e,f):O.touch&&e==="dblclick"?f=aa(t,f):"addEventListener"in t?e==="touchstart"||e==="touchmove"||e==="wheel"||e==="mousewheel"?t.addEventListener(fn[e]||e,f,O.passiveEvents?{passive:!1}:!1):e==="mouseenter"||e==="mouseleave"?(f=function(y){y=y||window.event,gn(t,y)&&g(y)},t.addEventListener(fn[e],f,!1)):t.addEventListener(e,g,!1):t.attachEvent("on"+e,f),t[zt]=t[zt]||{},t[zt][u]=f}function pn(t,e,s,a,u){u=u||e+_(s)+(a?"_"+_(a):"");var f=t[zt]&&t[zt][u];if(!f)return this;!O.touchNative&&O.pointer&&e.indexOf("touch")===0?ta(t,e,f):O.touch&&e==="dblclick"?ha(t,f):"removeEventListener"in t?t.removeEventListener(fn[e]||e,f,!1):t.detachEvent("on"+e,f),t[zt][u]=null}function he(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function mn(t){return _n(t,"wheel",he),this}function Ue(t){return j(t,"mousedown touchstart dblclick contextmenu",he),t._leaflet_disable_click=!0,this}function pt(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function le(t){return pt(t),he(t),this}function $s(t){if(t.composedPath)return t.composedPath();for(var e=[],s=t.target;s;)e.push(s),s=s.parentNode;return e}function zs(t,e){if(!e)return new M(t.clientX,t.clientY);var s=dn(e),a=s.boundingClientRect;return new M((t.clientX-a.left)/s.x-e.clientLeft,(t.clientY-a.top)/s.y-e.clientTop)}var ca=O.linux&&O.chrome?window.devicePixelRatio:O.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Bs(t){return O.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/ca:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function gn(t,e){var s=e.relatedTarget;if(!s)return!0;try{for(;s&&s!==t;)s=s.parentNode}catch{return!1}return s!==t}var da={__proto__:null,on:j,off:J,stopPropagation:he,disableScrollPropagation:mn,disableClickPropagation:Ue,preventDefault:pt,stop:le,getPropagationPath:$s,getMousePosition:zs,getWheelDelta:Bs,isExternalTarget:gn,addListener:j,removeListener:J},Ds=Ut.extend({run:function(t,e,s,a){this.stop(),this._el=t,this._inProgress=!0,this._duration=s||.25,this._easeOutPower=1/Math.max(a||.5,.2),this._startPos=ae(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Q(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,s=this._duration*1e3;e<s?this._runFrame(this._easeOut(e/s),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var s=this._startPos.add(this._offset.multiplyBy(t));e&&s._round(),st(this._el,s),this.fire("step")},_complete:function(){wt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),H=Ut.extend({options:{crs:Ji,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=P(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==void 0&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==void 0&&this.setView(F(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ze&&O.any3d&&!O.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),j(this._proxy,Is,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,s){if(e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter(F(t),e,this.options.maxBounds),s=s||{},this._stop(),this._loaded&&!s.reset&&s!==!0){s.animate!==void 0&&(s.zoom=h({animate:s.animate},s.zoom),s.pan=h({animate:s.animate,duration:s.duration},s.pan));var a=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,s.zoom):this._tryAnimatedPan(t,s.pan);if(a)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e,s.pan&&s.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(O.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(O.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,s){var a=this.getZoomScale(e),u=this.getSize().divideBy(2),f=t instanceof M?t:this.latLngToContainerPoint(t),g=f.subtract(u).multiplyBy(1-1/a),y=this.containerPointToLatLng(u.add(g));return this.setView(y,e,{zoom:s})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():nt(t);var s=I(e.paddingTopLeft||e.padding||[0,0]),a=I(e.paddingBottomRight||e.padding||[0,0]),u=this.getBoundsZoom(t,!1,s.add(a));if(u=typeof e.maxZoom=="number"?Math.min(e.maxZoom,u):u,u===1/0)return{center:t.getCenter(),zoom:u};var f=a.subtract(s).divideBy(2),g=this.project(t.getSouthWest(),u),y=this.project(t.getNorthEast(),u),w=this.unproject(g.add(y).divideBy(2).add(f),u);return{center:w,zoom:u}},fitBounds:function(t,e){if(t=nt(t),!t.isValid())throw new Error("Bounds are not valid.");var s=this._getBoundsCenterZoom(t,e);return this.setView(s.center,s.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=I(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ds,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){$(this._mapPane,"leaflet-pan-anim");var s=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,s,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,s){if(s=s||{},s.animate===!1||!O.any3d)return this.setView(t,e,s);this._stop();var a=this.project(this.getCenter()),u=this.project(t),f=this.getSize(),g=this._zoom;t=F(t),e=e===void 0?g:e;var y=Math.max(f.x,f.y),w=y*this.getZoomScale(g,e),x=u.distanceTo(a)||1,E=1.42,R=E*E;function D(rt){var ki=rt?-1:1,th=rt?w:y,eh=w*w-y*y+ki*R*R*x*x,ih=2*th*R*x,En=eh/ih,yr=Math.sqrt(En*En+1)-En,nh=yr<1e-9?-18:Math.log(yr);return nh}function yt(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function dt(rt){return(Math.exp(rt)+Math.exp(-rt))/2}function Et(rt){return yt(rt)/dt(rt)}var bt=D(0);function Le(rt){return y*(dt(bt)/dt(bt+E*rt))}function Ja(rt){return y*(dt(bt)*Et(bt+E*rt)-yt(bt))/R}function Ya(rt){return 1-Math.pow(1-rt,1.5)}var Xa=Date.now(),gr=(D(1)-bt)/E,Qa=s.duration?1e3*s.duration:1e3*gr*.8;function vr(){var rt=(Date.now()-Xa)/Qa,ki=Ya(rt)*gr;rt<=1?(this._flyToFrame=Q(vr,this),this._move(this.unproject(a.add(u.subtract(a).multiplyBy(Ja(ki)/x)),g),this.getScaleZoom(y/Le(ki),g),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,s.noMoveStart),vr.call(this),this},flyToBounds:function(t,e){var s=this._getBoundsCenterZoom(t,e);return this.flyTo(s.center,s.zoom,e)},setMaxBounds:function(t){return t=nt(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var s=this.getCenter(),a=this._limitCenter(s,this._zoom,nt(t));return s.equals(a)||this.panTo(a,e),this._enforcingBounds=!1,this},panInside:function(t,e){e=e||{};var s=I(e.paddingTopLeft||e.padding||[0,0]),a=I(e.paddingBottomRight||e.padding||[0,0]),u=this.project(this.getCenter()),f=this.project(t),g=this.getPixelBounds(),y=lt([g.min.add(s),g.max.subtract(a)]),w=y.getSize();if(!y.contains(f)){this._enforcingBounds=!0;var x=f.subtract(y.getCenter()),E=y.extend(f).getSize().subtract(w);u.x+=x.x<0?-E.x:E.x,u.y+=x.y<0?-E.y:E.y,this.panTo(this.unproject(u),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=h({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var s=this.getSize(),a=e.divideBy(2).round(),u=s.divideBy(2).round(),f=a.subtract(u);return!f.x&&!f.y?this:(t.animate&&t.pan?this.panBy(f):(t.pan&&this._rawPanBy(f),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:s}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=h({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=c(this._handleGeolocationResponse,this),s=c(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,s,t):navigator.geolocation.getCurrentPosition(e,s,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,s=t.message||(e===1?"permission denied":e===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+s+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=t.coords.latitude,s=t.coords.longitude,a=new K(e,s),u=a.toBounds(t.coords.accuracy*2),f=this._locateOptions;if(f.setView){var g=this.getBoundsZoom(u);this.setView(a,f.maxZoom?Math.min(g,f.maxZoom):g)}var y={latlng:a,bounds:u,timestamp:t.timestamp};for(var w in t.coords)typeof t.coords[w]=="number"&&(y[w]=t.coords[w]);this.fire("locationfound",y)}},addHandler:function(t,e){if(!e)return this;var s=this[t]=new e(this);return this._handlers.push(s),this.options[t]&&s.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(wt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)et(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var s="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),a=q("div",s,e||this._mapPane);return t&&(this._panes[t]=a),a},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),s=this.unproject(t.getTopRight());return new _t(e,s)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,s){t=nt(t),s=I(s||[0,0]);var a=this.getZoom()||0,u=this.getMinZoom(),f=this.getMaxZoom(),g=t.getNorthWest(),y=t.getSouthEast(),w=this.getSize().subtract(s),x=lt(this.project(y,a),this.project(g,a)).getSize(),E=O.any3d?this.options.zoomSnap:1,R=w.x/x.x,D=w.y/x.y,yt=e?Math.max(R,D):Math.min(R,D);return a=this.getScaleZoom(yt,a),E&&(a=Math.round(a/(E/100))*(E/100),a=e?Math.ceil(a/E)*E:Math.floor(a/E)*E),Math.max(u,Math.min(f,a))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new M(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var s=this._getTopLeftPoint(t,e);return new tt(s,s.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var s=this.options.crs;return e=e===void 0?this._zoom:e,s.scale(t)/s.scale(e)},getScaleZoom:function(t,e){var s=this.options.crs;e=e===void 0?this._zoom:e;var a=s.zoom(t*s.scale(e));return isNaN(a)?1/0:a},project:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.latLngToPoint(F(t),e)},unproject:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.pointToLatLng(I(t),e)},layerPointToLatLng:function(t){var e=I(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(F(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(F(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(nt(t))},distance:function(t,e){return this.options.crs.distance(F(t),F(e))},containerPointToLayerPoint:function(t){return I(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return I(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(I(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(t)))},mouseEventToContainerPoint:function(t){return zs(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=Ms(t);if(e){if(e._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");j(e,"scroll",this._onScroll,this),this._containerId=_(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&O.any3d,$(t,"leaflet-container"+(O.touch?" leaflet-touch":"")+(O.retina?" leaflet-retina":"")+(O.ielt9?" leaflet-oldie":"")+(O.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Be(t,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&e!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),st(this._mapPane,new M(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||($(t.markerPane,"leaflet-zoom-hide"),$(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,s){st(this._mapPane,new M(0,0));var a=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var u=this._zoom!==e;this._moveStart(u,s)._move(t,e)._moveEnd(u),this.fire("viewreset"),a&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,s,a){e===void 0&&(e=this._zoom);var u=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),a?s&&s.pinch&&this.fire("zoom",s):((u||s&&s.pinch)&&this.fire("zoom",s),this.fire("move",s)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return wt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){st(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[_(this._container)]=this;var e=t?J:j;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),O.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){wt(this._resizeRequest),this._resizeRequest=Q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var s=[],a,u=e==="mouseout"||e==="mouseover",f=t.target||t.srcElement,g=!1;f;){if(a=this._targets[_(f)],a&&(e==="click"||e==="preclick")&&this._draggableMoved(a)){g=!0;break}if(a&&a.listens(e,!0)&&(u&&!gn(f,t)||(s.push(a),u))||f===this._container)break;f=f.parentNode}return!s.length&&!g&&!u&&this.listens(e,!0)&&(s=[this]),s},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(e))){var s=t.type;s==="mousedown"&&cn(e),this._fireDOMEvent(t,s)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,s){if(t.type==="click"){var a=h({},t);a.type="preclick",this._fireDOMEvent(a,a.type,s)}var u=this._findEventTargets(t,e);if(s){for(var f=[],g=0;g<s.length;g++)s[g].listens(e,!0)&&f.push(s[g]);u=f.concat(u)}if(u.length){e==="contextmenu"&&pt(t);var y=u[0],w={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var x=y.getLatLng&&(!y._radius||y._radius<=10);w.containerPoint=x?this.latLngToContainerPoint(y.getLatLng()):this.mouseEventToContainerPoint(t),w.layerPoint=this.containerPointToLayerPoint(w.containerPoint),w.latlng=x?y.getLatLng():this.layerPointToLatLng(w.layerPoint)}for(g=0;g<u.length;g++)if(u[g].fire(e,w,!0),w.originalEvent._stopped||u[g].options.bubblingMouseEvents===!1&&U(this._mouseEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ae(this._mapPane)||new M(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var s=t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return s.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var s=this.getSize()._divideBy(2);return this.project(t,e)._subtract(s)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,s){var a=this._getNewPixelOrigin(s,e);return this.project(t,e)._subtract(a)},_latLngBoundsToNewLayerBounds:function(t,e,s){var a=this._getNewPixelOrigin(s,e);return lt([this.project(t.getSouthWest(),e)._subtract(a),this.project(t.getNorthWest(),e)._subtract(a),this.project(t.getSouthEast(),e)._subtract(a),this.project(t.getNorthEast(),e)._subtract(a)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,s){if(!s)return t;var a=this.project(t,e),u=this.getSize().divideBy(2),f=new tt(a.subtract(u),a.add(u)),g=this._getBoundsOffset(f,s,e);return Math.abs(g.x)<=1&&Math.abs(g.y)<=1?t:this.unproject(a.add(g),e)},_limitOffset:function(t,e){if(!e)return t;var s=this.getPixelBounds(),a=new tt(s.min.add(t),s.max.add(t));return t.add(this._getBoundsOffset(a,e))},_getBoundsOffset:function(t,e,s){var a=lt(this.project(e.getNorthEast(),s),this.project(e.getSouthWest(),s)),u=a.min.subtract(t.min),f=a.max.subtract(t.max),g=this._rebound(u.x,-f.x),y=this._rebound(u.y,-f.y);return new M(g,y)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),s=this.getMaxZoom(),a=O.any3d?this.options.zoomSnap:1;return a&&(t=Math.round(t/a)*a),Math.max(e,Math.min(s,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){it(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var s=this._getCenterOffset(t)._trunc();return(e&&e.animate)!==!0&&!this.getSize().contains(s)?!1:(this.panBy(s,e),!0)},_createAnimProxy:function(){var t=this._proxy=q("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var s=sn,a=this._proxy.style[s];oe(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),a===this._proxy.style[s]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();oe(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,s){if(this._animatingZoom)return!0;if(s=s||{},!this._zoomAnimated||s.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var a=this.getZoomScale(e),u=this._getCenterOffset(t)._divideBy(1-1/a);return s.animate!==!0&&!this.getSize().contains(u)?!1:(Q(function(){this._moveStart(!0,s.noMoveStart||!1)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,s,a){this._mapPane&&(s&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,$(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:a}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&it(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function fa(t,e){return new H(t,e)}var At=N.extend({options:{position:"topright"},initialize:function(t){P(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),s=this.getPosition(),a=t._controlCorners[s];return $(e,"leaflet-control"),s.indexOf("bottom")!==-1?a.insertBefore(e,a.firstChild):a.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Fe=function(t){return new At(t)};H.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",s=this._controlContainer=q("div",e+"control-container",this._container);function a(u,f){var g=e+u+" "+e+f;t[u+f]=q("div",g,s)}a("top","left"),a("top","right"),a("bottom","left"),a("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)et(this._controlCorners[t]);et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ns=At.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,s,a){return s<a?-1:a<s?1:0}},initialize:function(t,e,s){P(this,s),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var a in t)this._addLayer(t[a],a);for(a in e)this._addLayer(e[a],a,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return At.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(_(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){$(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?($(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):it(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return it(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=q("div",t),s=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ue(e),mn(e);var a=this._section=q("section",t+"-list");s&&(this._map.on("click",this.collapse,this),j(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var u=this._layersLink=q("a",t+"-toggle",e);u.href="#",u.title="Layers",u.setAttribute("role","button"),j(u,{keydown:function(f){f.keyCode===13&&this._expandSafely()},click:function(f){pt(f),this._expandSafely()}},this),s||this.expand(),this._baseLayersList=q("div",t+"-base",a),this._separator=q("div",t+"-separator",a),this._overlaysList=q("div",t+"-overlays",a),e.appendChild(a)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&_(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,s){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:s}),this.options.sortLayers&&this._layers.sort(c(function(a,u){return this.options.sortFunction(a.layer,u.layer,a.name,u.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;li(this._baseLayersList),li(this._overlaysList),this._layerControlInputs=[];var t,e,s,a,u=0;for(s=0;s<this._layers.length;s++)a=this._layers[s],this._addItem(a),e=e||a.overlay,t=t||!a.overlay,u+=a.overlay?0:1;return this.options.hideSingleBase&&(t=t&&u>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(_(t.target)),s=e.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;s&&this._map.fire(s,e)},_createRadioElement:function(t,e){var s='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",a=document.createElement("div");return a.innerHTML=s,a.firstChild},_addItem:function(t){var e=document.createElement("label"),s=this._map.hasLayer(t.layer),a;t.overlay?(a=document.createElement("input"),a.type="checkbox",a.className="leaflet-control-layers-selector",a.defaultChecked=s):a=this._createRadioElement("leaflet-base-layers_"+_(this),s),this._layerControlInputs.push(a),a.layerId=_(t.layer),j(a,"click",this._onInputClick,this);var u=document.createElement("span");u.innerHTML=" "+t.name;var f=document.createElement("span");e.appendChild(f),f.appendChild(a),f.appendChild(u);var g=t.overlay?this._overlaysList:this._baseLayersList;return g.appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,e,s,a=[],u=[];this._handlingClick=!0;for(var f=t.length-1;f>=0;f--)e=t[f],s=this._getLayer(e.layerId).layer,e.checked?a.push(s):e.checked||u.push(s);for(f=0;f<u.length;f++)this._map.hasLayer(u[f])&&this._map.removeLayer(u[f]);for(f=0;f<a.length;f++)this._map.hasLayer(a[f])||this._map.addLayer(a[f]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,e,s,a=this._map.getZoom(),u=t.length-1;u>=0;u--)e=t[u],s=this._getLayer(e.layerId).layer,e.disabled=s.options.minZoom!==void 0&&a<s.options.minZoom||s.options.maxZoom!==void 0&&a>s.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,j(t,"click",pt),this.expand();var e=this;setTimeout(function(){J(t,"click",pt),e._preventClick=!1})}}),_a=function(t,e,s){return new Ns(t,e,s)},vn=At.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",s=q("div",e+" leaflet-bar"),a=this.options;return this._zoomInButton=this._createButton(a.zoomInText,a.zoomInTitle,e+"-in",s,this._zoomIn),this._zoomOutButton=this._createButton(a.zoomOutText,a.zoomOutTitle,e+"-out",s,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),s},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,s,a,u){var f=q("a",s,a);return f.innerHTML=t,f.href="#",f.title=e,f.setAttribute("role","button"),f.setAttribute("aria-label",e),Ue(f),j(f,"click",le),j(f,"click",u,this),j(f,"click",this._refocusOnMap,this),f},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";it(this._zoomInButton,e),it(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&($(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&($(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});H.mergeOptions({zoomControl:!0}),H.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new vn,this.addControl(this.zoomControl))});var pa=function(t){return new vn(t)},Zs=At.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",s=q("div",e),a=this.options;return this._addScales(a,e+"-line",s),t.on(a.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),s},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,s){t.metric&&(this._mScale=q("div",e,s)),t.imperial&&(this._iScale=q("div",e,s))},_update:function(){var t=this._map,e=t.getSize().y/2,s=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(s)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),s=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,s,e/t)},_updateImperial:function(t){var e=t*3.2808399,s,a,u;e>5280?(s=e/5280,a=this._getRoundNum(s),this._updateScale(this._iScale,a+" mi",a/s)):(u=this._getRoundNum(e),this._updateScale(this._iScale,u+" ft",u/e))},_updateScale:function(t,e,s){t.style.width=Math.round(this.options.maxWidth*s)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),s=t/e;return s=s>=10?10:s>=5?5:s>=3?3:s>=2?2:1,e*s}}),ma=function(t){return new Zs(t)},ga='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',yn=At.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(O.inlineSvg?ga+" ":"")+"Leaflet</a>"},initialize:function(t){P(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=q("div","leaflet-control-attribution"),Ue(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var s=[];this.options.prefix&&s.push(this.options.prefix),t.length&&s.push(t.join(", ")),this._container.innerHTML=s.join(' <span aria-hidden="true">|</span> ')}}});H.mergeOptions({attributionControl:!0}),H.addInitHook(function(){this.options.attributionControl&&new yn().addTo(this)});var va=function(t){return new yn(t)};At.Layers=Ns,At.Zoom=vn,At.Scale=Zs,At.Attribution=yn,Fe.layers=_a,Fe.zoom=pa,Fe.scale=ma,Fe.attribution=va;var Bt=N.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Bt.addTo=function(t,e){return t.addHandler(e,this),this};var ya={Events:ct},Us=O.touch?"touchstart mousedown":"mousedown",Yt=Ut.extend({options:{clickTolerance:3},initialize:function(t,e,s,a){P(this,a),this._element=t,this._dragStartTarget=e||t,this._preventOutline=s},enable:function(){this._enabled||(j(this._dragStartTarget,Us,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Yt._dragging===this&&this.finishDrag(!0),J(this._dragStartTarget,Us,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!rn(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){Yt._dragging===this&&this.finishDrag();return}if(!(Yt._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(Yt._dragging=this,this._preventOutline&&cn(this._element),hn(),De(),!this._moving)){this.fire("down");var e=t.touches?t.touches[0]:t,s=Rs(this._element);this._startPoint=new M(e.clientX,e.clientY),this._startPos=ae(this._element),this._parentScale=dn(s);var a=t.type==="mousedown";j(document,a?"mousemove":"touchmove",this._onMove,this),j(document,a?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var e=t.touches&&t.touches.length===1?t.touches[0]:t,s=new M(e.clientX,e.clientY)._subtract(this._startPoint);!s.x&&!s.y||Math.abs(s.x)+Math.abs(s.y)<this.options.clickTolerance||(s.x/=this._parentScale.x,s.y/=this._parentScale.y,pt(t),this._moved||(this.fire("dragstart"),this._moved=!0,$(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),$(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(s),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),st(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){it(document.body,"leaflet-dragging"),this._lastTarget&&(it(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),J(document,"mousemove touchmove",this._onMove,this),J(document,"mouseup touchend touchcancel",this._onUp,this),ln(),Ne();var e=this._moved&&this._moving;this._moving=!1,Yt._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Fs(t,e,s){var a,u=[1,4,2,8],f,g,y,w,x,E,R,D;for(f=0,E=t.length;f<E;f++)t[f]._code=ue(t[f],e);for(y=0;y<4;y++){for(R=u[y],a=[],f=0,E=t.length,g=E-1;f<E;g=f++)w=t[f],x=t[g],w._code&R?x._code&R||(D=_i(x,w,R,e,s),D._code=ue(D,e),a.push(D)):(x._code&R&&(D=_i(x,w,R,e,s),D._code=ue(D,e),a.push(D)),a.push(w));t=a}return t}function Hs(t,e){var s,a,u,f,g,y,w,x,E;if(!t||t.length===0)throw new Error("latlngs not passed");St(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var R=F([0,0]),D=nt(t),yt=D.getNorthWest().distanceTo(D.getSouthWest())*D.getNorthEast().distanceTo(D.getNorthWest());yt<1700&&(R=wn(t));var dt=t.length,Et=[];for(s=0;s<dt;s++){var bt=F(t[s]);Et.push(e.project(F([bt.lat-R.lat,bt.lng-R.lng])))}for(y=w=x=0,s=0,a=dt-1;s<dt;a=s++)u=Et[s],f=Et[a],g=u.y*f.x-f.y*u.x,w+=(u.x+f.x)*g,x+=(u.y+f.y)*g,y+=g*3;y===0?E=Et[0]:E=[w/y,x/y];var Le=e.unproject(I(E));return F([Le.lat+R.lat,Le.lng+R.lng])}function wn(t){for(var e=0,s=0,a=0,u=0;u<t.length;u++){var f=F(t[u]);e+=f.lat,s+=f.lng,a++}return F([e/a,s/a])}var wa={__proto__:null,clipPolygon:Fs,polygonCenter:Hs,centroid:wn};function qs(t,e){if(!e||!t.length)return t.slice();var s=e*e;return t=xa(t,s),t=Pa(t,s),t}function Ws(t,e,s){return Math.sqrt(He(t,e,s,!0))}function ba(t,e,s){return He(t,e,s)}function Pa(t,e){var s=t.length,a=typeof Uint8Array<"u"?Uint8Array:Array,u=new a(s);u[0]=u[s-1]=1,bn(t,u,e,0,s-1);var f,g=[];for(f=0;f<s;f++)u[f]&&g.push(t[f]);return g}function bn(t,e,s,a,u){var f=0,g,y,w;for(y=a+1;y<=u-1;y++)w=He(t[y],t[a],t[u],!0),w>f&&(g=y,f=w);f>s&&(e[g]=1,bn(t,e,s,a,g),bn(t,e,s,g,u))}function xa(t,e){for(var s=[t[0]],a=1,u=0,f=t.length;a<f;a++)Ta(t[a],t[u])>e&&(s.push(t[a]),u=a);return u<f-1&&s.push(t[f-1]),s}var Gs;function Vs(t,e,s,a,u){var f=a?Gs:ue(t,s),g=ue(e,s),y,w,x;for(Gs=g;;){if(!(f|g))return[t,e];if(f&g)return!1;y=f||g,w=_i(t,e,y,s,u),x=ue(w,s),y===f?(t=w,f=x):(e=w,g=x)}}function _i(t,e,s,a,u){var f=e.x-t.x,g=e.y-t.y,y=a.min,w=a.max,x,E;return s&8?(x=t.x+f*(w.y-t.y)/g,E=w.y):s&4?(x=t.x+f*(y.y-t.y)/g,E=y.y):s&2?(x=w.x,E=t.y+g*(w.x-t.x)/f):s&1&&(x=y.x,E=t.y+g*(y.x-t.x)/f),new M(x,E,u)}function ue(t,e){var s=0;return t.x<e.min.x?s|=1:t.x>e.max.x&&(s|=2),t.y<e.min.y?s|=4:t.y>e.max.y&&(s|=8),s}function Ta(t,e){var s=e.x-t.x,a=e.y-t.y;return s*s+a*a}function He(t,e,s,a){var u=e.x,f=e.y,g=s.x-u,y=s.y-f,w=g*g+y*y,x;return w>0&&(x=((t.x-u)*g+(t.y-f)*y)/w,x>1?(u=s.x,f=s.y):x>0&&(u+=g*x,f+=y*x)),g=t.x-u,y=t.y-f,a?g*g+y*y:new M(u,f)}function St(t){return!z(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Ks(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),St(t)}function Js(t,e){var s,a,u,f,g,y,w,x;if(!t||t.length===0)throw new Error("latlngs not passed");St(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var E=F([0,0]),R=nt(t),D=R.getNorthWest().distanceTo(R.getSouthWest())*R.getNorthEast().distanceTo(R.getNorthWest());D<1700&&(E=wn(t));var yt=t.length,dt=[];for(s=0;s<yt;s++){var Et=F(t[s]);dt.push(e.project(F([Et.lat-E.lat,Et.lng-E.lng])))}for(s=0,a=0;s<yt-1;s++)a+=dt[s].distanceTo(dt[s+1])/2;if(a===0)x=dt[0];else for(s=0,f=0;s<yt-1;s++)if(g=dt[s],y=dt[s+1],u=g.distanceTo(y),f+=u,f>a){w=(f-a)/u,x=[y.x-w*(y.x-g.x),y.y-w*(y.y-g.y)];break}var bt=e.unproject(I(x));return F([bt.lat+E.lat,bt.lng+E.lng])}var ka={__proto__:null,simplify:qs,pointToSegmentDistance:Ws,closestPointOnSegment:ba,clipSegment:Vs,_getEdgeIntersection:_i,_getBitCode:ue,_sqClosestPointOnSegment:He,isFlat:St,_flat:Ks,polylineCenter:Js},Pn={project:function(t){return new M(t.lng,t.lat)},unproject:function(t){return new K(t.y,t.x)},bounds:new tt([-180,-90],[180,90])},xn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new tt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var e=Math.PI/180,s=this.R,a=t.lat*e,u=this.R_MINOR/s,f=Math.sqrt(1-u*u),g=f*Math.sin(a),y=Math.tan(Math.PI/4-a/2)/Math.pow((1-g)/(1+g),f/2);return a=-s*Math.log(Math.max(y,1e-10)),new M(t.lng*e*s,a)},unproject:function(t){for(var e=180/Math.PI,s=this.R,a=this.R_MINOR/s,u=Math.sqrt(1-a*a),f=Math.exp(-t.y/s),g=Math.PI/2-2*Math.atan(f),y=0,w=.1,x;y<15&&Math.abs(w)>1e-7;y++)x=u*Math.sin(g),x=Math.pow((1-x)/(1+x),u/2),w=Math.PI/2-2*Math.atan(f*x)-g,g+=w;return new K(g*e,t.x*e/s)}},La={__proto__:null,LonLat:Pn,Mercator:xn,SphericalMercator:Vi},Sa=h({},Jt,{code:"EPSG:3395",projection:xn,transformation:function(){var t=.5/(Math.PI*xn.R);return je(t,.5,-t,.5)}()}),Ys=h({},Jt,{code:"EPSG:4326",projection:Pn,transformation:je(1/180,1,-1/180,.5)}),Ea=h({},Ft,{projection:Pn,transformation:je(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var s=e.lng-t.lng,a=e.lat-t.lat;return Math.sqrt(s*s+a*a)},infinite:!0});Ft.Earth=Jt,Ft.EPSG3395=Sa,Ft.EPSG3857=Ji,Ft.EPSG900913=Ro,Ft.EPSG4326=Ys,Ft.Simple=Ea;var It=Ut.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[_(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[_(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var s=this.getEvents();e.on(s,this),this.once("remove",function(){e.off(s,this)},this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});H.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=_(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=_(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return _(t)in this._layers},eachLayer:function(t,e){for(var s in this._layers)t.call(e,this._layers[s]);return this},_addLayers:function(t){t=t?z(t)?t:[t]:[];for(var e=0,s=t.length;e<s;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[_(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=_(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,s=this._getZoomSpan();for(var a in this._zoomBoundLayers){var u=this._zoomBoundLayers[a].options;t=u.minZoom===void 0?t:Math.min(t,u.minZoom),e=u.maxZoom===void 0?e:Math.max(e,u.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,s!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var be=It.extend({initialize:function(t,e){P(this,e),this._layers={};var s,a;if(t)for(s=0,a=t.length;s<a;s++)this.addLayer(t[s])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){var e=typeof t=="number"?t:this.getLayerId(t);return e in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e=Array.prototype.slice.call(arguments,1),s,a;for(s in this._layers)a=this._layers[s],a[t]&&a[t].apply(a,e);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var s in this._layers)t.call(e,this._layers[s]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return _(t)}}),Ca=function(t,e){return new be(t,e)},Ht=be.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),be.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),be.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new _t;for(var e in this._layers){var s=this._layers[e];t.extend(s.getBounds?s.getBounds():s.getLatLng())}return t}}),Oa=function(t,e){return new Ht(t,e)},Pe=N.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){P(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var s=this._getIconUrl(t);if(!s){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var a=this._createImg(s,e&&e.tagName==="IMG"?e:null);return this._setIconStyles(a,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),a},_setIconStyles:function(t,e){var s=this.options,a=s[e+"Size"];typeof a=="number"&&(a=[a,a]);var u=I(a),f=I(e==="shadow"&&s.shadowAnchor||s.iconAnchor||u&&u.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(s.className||""),f&&(t.style.marginLeft=-f.x+"px",t.style.marginTop=-f.y+"px"),u&&(t.style.width=u.x+"px",t.style.height=u.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return O.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Aa(t){return new Pe(t)}var qe=Pe.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof qe.imagePath!="string"&&(qe.imagePath=this._detectIconPath()),(this.options.imagePath||qe.imagePath)+Pe.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(s,a,u){var f=a.exec(s);return f&&f[u]};return t=e(t,/^url\((['"])?(.+)\1\)$/,2),t&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=q("div","leaflet-default-icon-path",document.body),e=Be(t,"background-image")||Be(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e),e)return e;var s=document.querySelector('link[href$="leaflet.css"]');return s?s.href.substring(0,s.href.length-11-1):""}}),Xs=Bt.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Yt(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),$(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&it(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,s=e._map,a=this._marker.options.autoPanSpeed,u=this._marker.options.autoPanPadding,f=ae(e._icon),g=s.getPixelBounds(),y=s.getPixelOrigin(),w=lt(g.min._subtract(y).add(u),g.max._subtract(y).subtract(u));if(!w.contains(f)){var x=I((Math.max(w.max.x,f.x)-w.max.x)/(g.max.x-w.max.x)-(Math.min(w.min.x,f.x)-w.min.x)/(g.min.x-w.min.x),(Math.max(w.max.y,f.y)-w.max.y)/(g.max.y-w.max.y)-(Math.min(w.min.y,f.y)-w.min.y)/(g.min.y-w.min.y)).multiplyBy(a);s.panBy(x,{animate:!1}),this._draggable._newPos._add(x),this._draggable._startPos._add(x),st(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=Q(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(wt(this._panRequest),this._panRequest=Q(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,s=e._shadow,a=ae(e._icon),u=e._map.layerPointToLatLng(a);s&&st(s,a),e._latlng=u,t.latlng=u,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){wt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),pi=It.extend({options:{icon:new qe,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){P(this,e),this._latlng=F(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),s=t.icon.createIcon(this._icon),a=!1;s!==this._icon&&(this._icon&&this._removeIcon(),a=!0,t.title&&(s.title=t.title),s.tagName==="IMG"&&(s.alt=t.alt||"")),$(s,e),t.keyboard&&(s.tabIndex="0",s.setAttribute("role","button")),this._icon=s,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&j(s,"focus",this._panOnFocus,this);var u=t.icon.createShadow(this._shadow),f=!1;u!==this._shadow&&(this._removeShadow(),f=!0),u&&($(u,e),u.alt=""),this._shadow=u,t.opacity<1&&this._updateOpacity(),a&&this.getPane().appendChild(this._icon),this._initInteraction(),u&&f&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&J(this._icon,"focus",this._panOnFocus,this),et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&et(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&st(this._icon,t),this._shadow&&st(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&($(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Xs)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Xs(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Lt(this._icon,t),this._shadow&&Lt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,s=e.iconSize?I(e.iconSize):I(0,0),a=e.iconAnchor?I(e.iconAnchor):I(0,0);t.panInside(this._latlng,{paddingTopLeft:a,paddingBottomRight:s.subtract(a)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ia(t,e){return new pi(t,e)}var Xt=It.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return P(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),mi=Xt.extend({options:{fill:!0,radius:10},initialize:function(t,e){P(this,e),this._latlng=F(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Xt.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,s=this._clickTolerance(),a=[t+s,e+s];this._pxBounds=new tt(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ma(t,e){return new mi(t,e)}var Tn=mi.extend({initialize:function(t,e,s){if(typeof e=="number"&&(e=h({},s,{radius:e})),P(this,e),this._latlng=F(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new _t(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Xt.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,s=this._map,a=s.options.crs;if(a.distance===Jt.distance){var u=Math.PI/180,f=this._mRadius/Jt.R/u,g=s.project([e+f,t]),y=s.project([e-f,t]),w=g.add(y).divideBy(2),x=s.unproject(w).lat,E=Math.acos((Math.cos(f*u)-Math.sin(e*u)*Math.sin(x*u))/(Math.cos(e*u)*Math.cos(x*u)))/u;(isNaN(E)||E===0)&&(E=f/Math.cos(Math.PI/180*e)),this._point=w.subtract(s.getPixelOrigin()),this._radius=isNaN(E)?0:w.x-s.project([x,t-E]).x,this._radiusY=w.y-g.y}else{var R=a.unproject(a.project(this._latlng).subtract([this._mRadius,0]));this._point=s.latLngToLayerPoint(this._latlng),this._radius=this._point.x-s.latLngToLayerPoint(R).x}this._updateBounds()}});function Ra(t,e,s){return new Tn(t,e,s)}var qt=Xt.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){P(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,s=null,a=He,u,f,g=0,y=this._parts.length;g<y;g++)for(var w=this._parts[g],x=1,E=w.length;x<E;x++){u=w[x-1],f=w[x];var R=a(t,u,f,!0);R<e&&(e=R,s=a(t,u,f))}return s&&(s.distance=Math.sqrt(e)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Js(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=F(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new _t,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return St(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],s=St(t),a=0,u=t.length;a<u;a++)s?(e[a]=F(t[a]),this._bounds.extend(e[a])):e[a]=this._convertLatLngs(t[a]);return e},_project:function(){var t=new tt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new M(t,t);this._rawPxBounds&&(this._pxBounds=new tt([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,s){var a=t[0]instanceof K,u=t.length,f,g;if(a){for(g=[],f=0;f<u;f++)g[f]=this._map.latLngToLayerPoint(t[f]),s.extend(g[f]);e.push(g)}else for(f=0;f<u;f++)this._projectLatlngs(t[f],e,s)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var e=this._parts,s,a,u,f,g,y,w;for(s=0,u=0,f=this._rings.length;s<f;s++)for(w=this._rings[s],a=0,g=w.length;a<g-1;a++)y=Vs(w[a],w[a+1],t,a,!0),y&&(e[u]=e[u]||[],e[u].push(y[0]),(y[1]!==w[a+1]||a===g-2)&&(e[u].push(y[1]),u++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,s=0,a=t.length;s<a;s++)t[s]=qs(t[s],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var s,a,u,f,g,y,w=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(s=0,f=this._parts.length;s<f;s++)for(y=this._parts[s],a=0,g=y.length,u=g-1;a<g;u=a++)if(!(!e&&a===0)&&Ws(t,y[u],y[a])<=w)return!0;return!1}});function ja(t,e){return new qt(t,e)}qt._flat=Ks;var xe=qt.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Hs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=qt.prototype._convertLatLngs.call(this,t),s=e.length;return s>=2&&e[0]instanceof K&&e[0].equals(e[s-1])&&e.pop(),e},_setLatLngs:function(t){qt.prototype._setLatLngs.call(this,t),St(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return St(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,s=new M(e,e);if(t=new tt(t.min.subtract(s),t.max.add(s)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var a=0,u=this._rings.length,f;a<u;a++)f=Fs(this._rings[a],t,!0),f.length&&this._parts.push(f)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e=!1,s,a,u,f,g,y,w,x;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(f=0,w=this._parts.length;f<w;f++)for(s=this._parts[f],g=0,x=s.length,y=x-1;g<x;y=g++)a=s[g],u=s[y],a.y>t.y!=u.y>t.y&&t.x<(u.x-a.x)*(t.y-a.y)/(u.y-a.y)+a.x&&(e=!e);return e||qt.prototype._containsPoint.call(this,t,!0)}});function $a(t,e){return new xe(t,e)}var Wt=Ht.extend({initialize:function(t,e){P(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e=z(t)?t:t.features,s,a,u;if(e){for(s=0,a=e.length;s<a;s++)u=e[s],(u.geometries||u.geometry||u.features||u.coordinates)&&this.addData(u);return this}var f=this.options;if(f.filter&&!f.filter(t))return this;var g=gi(t,f);return g?(g.feature=wi(t),g.defaultOptions=g.options,this.resetStyle(g),f.onEachFeature&&f.onEachFeature(t,g),this.addLayer(g)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=h({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&(typeof e=="function"&&(e=e(t.feature)),t.setStyle(e))}});function gi(t,e){var s=t.type==="Feature"?t.geometry:t,a=s?s.coordinates:null,u=[],f=e&&e.pointToLayer,g=e&&e.coordsToLatLng||kn,y,w,x,E;if(!a&&!s)return null;switch(s.type){case"Point":return y=g(a),Qs(f,t,y,e);case"MultiPoint":for(x=0,E=a.length;x<E;x++)y=g(a[x]),u.push(Qs(f,t,y,e));return new Ht(u);case"LineString":case"MultiLineString":return w=vi(a,s.type==="LineString"?0:1,g),new qt(w,e);case"Polygon":case"MultiPolygon":return w=vi(a,s.type==="Polygon"?1:2,g),new xe(w,e);case"GeometryCollection":for(x=0,E=s.geometries.length;x<E;x++){var R=gi({geometry:s.geometries[x],type:"Feature",properties:t.properties},e);R&&u.push(R)}return new Ht(u);case"FeatureCollection":for(x=0,E=s.features.length;x<E;x++){var D=gi(s.features[x],e);D&&u.push(D)}return new Ht(u);default:throw new Error("Invalid GeoJSON object.")}}function Qs(t,e,s,a){return t?t(e,s):new pi(s,a&&a.markersInheritOptions&&a)}function kn(t){return new K(t[1],t[0],t[2])}function vi(t,e,s){for(var a=[],u=0,f=t.length,g;u<f;u++)g=e?vi(t[u],e-1,s):(s||kn)(t[u]),a.push(g);return a}function Ln(t,e){return t=F(t),t.alt!==void 0?[b(t.lng,e),b(t.lat,e),b(t.alt,e)]:[b(t.lng,e),b(t.lat,e)]}function yi(t,e,s,a){for(var u=[],f=0,g=t.length;f<g;f++)u.push(e?yi(t[f],St(t[f])?0:e-1,s,a):Ln(t[f],a));return!e&&s&&u.length>0&&u.push(u[0].slice()),u}function Te(t,e){return t.feature?h({},t.feature,{geometry:e}):wi(e)}function wi(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Sn={toGeoJSON:function(t){return Te(this,{type:"Point",coordinates:Ln(this.getLatLng(),t)})}};pi.include(Sn),Tn.include(Sn),mi.include(Sn),qt.include({toGeoJSON:function(t){var e=!St(this._latlngs),s=yi(this._latlngs,e?1:0,!1,t);return Te(this,{type:(e?"Multi":"")+"LineString",coordinates:s})}}),xe.include({toGeoJSON:function(t){var e=!St(this._latlngs),s=e&&!St(this._latlngs[0]),a=yi(this._latlngs,s?2:e?1:0,!0,t);return e||(a=[a]),Te(this,{type:(s?"Multi":"")+"Polygon",coordinates:a})}}),be.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(s){e.push(s.toGeoJSON(t).geometry.coordinates)}),Te(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint(t);var s=e==="GeometryCollection",a=[];return this.eachLayer(function(u){if(u.toGeoJSON){var f=u.toGeoJSON(t);if(s)a.push(f.geometry);else{var g=wi(f);g.type==="FeatureCollection"?a.push.apply(a,g.features):a.push(g)}}}),s?Te(this,{geometries:a,type:"GeometryCollection"}):{type:"FeatureCollection",features:a}}});function tr(t,e){return new Wt(t,e)}var za=tr,bi=It.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,s){this._url=t,this._bounds=nt(e),P(this,s)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&($(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ye(this._image),this},bringToBack:function(){return this._map&&we(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=nt(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",e=this._image=t?this._url:q("img");if($(e,"leaflet-image-layer"),this._zoomAnimated&&$(e,"leaflet-zoom-animated"),this.options.className&&$(e,this.options.className),e.onselectstart=v,e.onmousemove=v,e.onload=c(this.fire,this,"load"),e.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=e.src;return}e.src=this._url,e.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),s=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;oe(this._image,s,e)},_reset:function(){var t=this._image,e=new tt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),s=e.getSize();st(t,e.min),t.style.width=s.x+"px",t.style.height=s.y+"px"},_updateOpacity:function(){Lt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ba=function(t,e,s){return new bi(t,e,s)},er=bi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",e=this._image=t?this._url:q("video");if($(e,"leaflet-image-layer"),this._zoomAnimated&&$(e,"leaflet-zoom-animated"),this.options.className&&$(e,this.options.className),e.onselectstart=v,e.onmousemove=v,e.onloadeddata=c(this.fire,this,"load"),t){for(var s=e.getElementsByTagName("source"),a=[],u=0;u<s.length;u++)a.push(s[u].src);this._url=s.length>0?a:[e.src];return}z(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var f=0;f<this._url.length;f++){var g=q("source");g.src=this._url[f],e.appendChild(g)}}});function Da(t,e,s){return new er(t,e,s)}var ir=bi.extend({_initImage:function(){var t=this._image=this._url;$(t,"leaflet-image-layer"),this._zoomAnimated&&$(t,"leaflet-zoom-animated"),this.options.className&&$(t,this.options.className),t.onselectstart=v,t.onmousemove=v}});function Na(t,e,s){return new ir(t,e,s)}var Dt=It.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof K||z(t))?(this._latlng=F(t),P(this,e)):(P(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Lt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Lt(this._container,1),this.bringToFront(),this.options.interactive&&($(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Lt(this._container,0),this._removeTimeout=setTimeout(c(et,void 0,this._container),200)):et(this._container),this.options.interactive&&(it(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=F(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ye(this._container),this},bringToBack:function(){return this._map&&we(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Ht){e=null;var s=this._source._layers;for(var a in s)if(s[a]._map){e=s[a];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else if(e.getBounds)t=e.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=I(this.options.offset),s=this._getAnchor();this._zoomAnimated?st(this._container,t.add(s)):e=e.add(t).add(s);var a=this._containerBottom=-e.y,u=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=a+"px",this._container.style.left=u+"px"}},_getAnchor:function(){return[0,0]}});H.include({_initOverlay:function(t,e,s,a){var u=e;return u instanceof t||(u=new t(a).setContent(e)),s&&u.setLatLng(s),u}}),It.include({_initOverlay:function(t,e,s,a){var u=s;return u instanceof t?(P(u,a),u._source=this):(u=e&&!a?e:new t(a,this),u.setContent(s)),u}});var Pi=Dt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Dt.prototype.openOn.call(this,t)},onAdd:function(t){Dt.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Xt||this._source.on("preclick",he))},onRemove:function(t){Dt.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Xt||this._source.off("preclick",he))},getEvents:function(){var t=Dt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=q("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),s=this._wrapper=q("div",t+"-content-wrapper",e);if(this._contentNode=q("div",t+"-content",s),Ue(e),mn(this._contentNode),j(e,"contextmenu",he),this._tipContainer=q("div",t+"-tip-container",e),this._tip=q("div",t+"-tip",this._tipContainer),this.options.closeButton){var a=this._closeButton=q("a",t+"-close-button",e);a.setAttribute("role","button"),a.setAttribute("aria-label","Close popup"),a.href="#close",a.innerHTML='<span aria-hidden="true">&#215;</span>',j(a,"click",function(u){pt(u),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var s=t.offsetWidth;s=Math.min(s,this.options.maxWidth),s=Math.max(s,this.options.minWidth),e.width=s+1+"px",e.whiteSpace="",e.height="";var a=t.offsetHeight,u=this.options.maxHeight,f="leaflet-popup-scrolled";u&&a>u?(e.height=u+"px",$(t,f)):it(t,f),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),s=this._getAnchor();st(this._container,e.add(s))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,e=parseInt(Be(this._container,"marginBottom"),10)||0,s=this._container.offsetHeight+e,a=this._containerWidth,u=new M(this._containerLeft,-s-this._containerBottom);u._add(ae(this._container));var f=t.layerPointToContainerPoint(u),g=I(this.options.autoPanPadding),y=I(this.options.autoPanPaddingTopLeft||g),w=I(this.options.autoPanPaddingBottomRight||g),x=t.getSize(),E=0,R=0;f.x+a+w.x>x.x&&(E=f.x+a-x.x+w.x),f.x-E-y.x<0&&(E=f.x-y.x),f.y+s+w.y>x.y&&(R=f.y+s-x.y+w.y),f.y-R-y.y<0&&(R=f.y-y.y),(E||R)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([E,R]))}},_getAnchor:function(){return I(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Za=function(t,e){return new Pi(t,e)};H.mergeOptions({closePopupOnClick:!0}),H.include({openPopup:function(t,e,s){return this._initOverlay(Pi,t,e,s).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),It.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Pi,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Ht||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){le(t);var e=t.layer||t.target;if(this._popup._source===e&&!(e instanceof Xt)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=e,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var xi=Dt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Dt.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Dt.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Dt.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=q("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,s,a=this._map,u=this._container,f=a.latLngToContainerPoint(a.getCenter()),g=a.layerPointToContainerPoint(t),y=this.options.direction,w=u.offsetWidth,x=u.offsetHeight,E=I(this.options.offset),R=this._getAnchor();y==="top"?(e=w/2,s=x):y==="bottom"?(e=w/2,s=0):y==="center"?(e=w/2,s=x/2):y==="right"?(e=0,s=x/2):y==="left"?(e=w,s=x/2):g.x<f.x?(y="right",e=0,s=x/2):(y="left",e=w+(E.x+R.x)*2,s=x/2),t=t.subtract(I(e,s,!0)).add(E).add(R),it(u,"leaflet-tooltip-right"),it(u,"leaflet-tooltip-left"),it(u,"leaflet-tooltip-top"),it(u,"leaflet-tooltip-bottom"),$(u,"leaflet-tooltip-"+y),st(u,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Lt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return I(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ua=function(t,e){return new xi(t,e)};H.include({openTooltip:function(t,e,s){return this._initOverlay(xi,t,e,s).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),It.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(xi,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var e=t?"off":"on",s={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?s.add=this._openTooltip:(s.mouseover=this._openTooltip,s.mouseout=this.closeTooltip,s.click=this._openTooltip,this._map?this._addFocusListeners():s.add=this._addFocusListeners),this._tooltip.options.sticky&&(s.mousemove=this._moveTooltip),this[e](s),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Ht||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&(j(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),j(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",function(){e._openOnceFlag=!1,e._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var e=t.latlng,s,a;this._tooltip.options.sticky&&t.originalEvent&&(s=this._map.mouseEventToContainerPoint(t.originalEvent),a=this._map.containerPointToLayerPoint(s),e=this._map.layerPointToLatLng(a)),this._tooltip.setLatLng(e)}});var nr=Pe.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&t.tagName==="DIV"?t:document.createElement("div"),s=this.options;if(s.html instanceof Element?(li(e),e.appendChild(s.html)):e.innerHTML=s.html!==!1?s.html:"",s.bgPos){var a=I(s.bgPos);e.style.backgroundPosition=-a.x+"px "+-a.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Fa(t){return new nr(t)}Pe.Default=qe;var We=It.extend({options:{tileSize:256,opacity:1,updateWhenIdle:O.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){P(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),et(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ye(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(we(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof M?t:new M(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e=this.getPane().children,s=-t(-1/0,1/0),a=0,u=e.length,f;a<u;a++)f=e[a].style.zIndex,e[a]!==this._container&&f&&(s=t(s,+f));isFinite(s)&&(this.options.zIndex=s+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!O.ielt9){Lt(this._container,this.options.opacity);var t=+new Date,e=!1,s=!1;for(var a in this._tiles){var u=this._tiles[a];if(!(!u.current||!u.loaded)){var f=Math.min(1,(t-u.loaded)/200);Lt(u.el,f),f<1?e=!0:(u.active?s=!0:this._onOpaqueTile(u),u.active=!0)}}s&&!this._noPrune&&this._pruneTiles(),e&&(wt(this._fadeFrame),this._fadeFrame=Q(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=q("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t!==void 0){for(var s in this._levels)s=Number(s),this._levels[s].el.children.length||s===t?(this._levels[s].el.style.zIndex=e-Math.abs(t-s),this._onUpdateLevel(s)):(et(this._levels[s].el),this._removeTilesAtZoom(s),this._onRemoveLevel(s),delete this._levels[s]);var a=this._levels[t],u=this._map;return a||(a=this._levels[t]={},a.el=q("div","leaflet-tile-container leaflet-zoom-animated",this._container),a.el.style.zIndex=e,a.origin=u.project(u.unproject(u.getPixelOrigin()),t).round(),a.zoom=t,this._setZoomTransform(a,u.getCenter(),u.getZoom()),v(a.el.offsetWidth),this._onCreateLevel(a)),this._level=a,a}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var t,e,s=this._map.getZoom();if(s>this.options.maxZoom||s<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var a=e.coords;this._retainParent(a.x,a.y,a.z,a.z-5)||this._retainChildren(a.x,a.y,a.z,a.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)et(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,s,a){var u=Math.floor(t/2),f=Math.floor(e/2),g=s-1,y=new M(+u,+f);y.z=+g;var w=this._tileCoordsToKey(y),x=this._tiles[w];return x&&x.active?(x.retain=!0,!0):(x&&x.loaded&&(x.retain=!0),g>a?this._retainParent(u,f,g,a):!1)},_retainChildren:function(t,e,s,a){for(var u=2*t;u<2*t+2;u++)for(var f=2*e;f<2*e+2;f++){var g=new M(u,f);g.z=s+1;var y=this._tileCoordsToKey(g),w=this._tiles[y];if(w&&w.active){w.retain=!0;continue}else w&&w.loaded&&(w.retain=!0);s+1<a&&this._retainChildren(u,f,s+1,a)}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,s,a){var u=Math.round(e);this.options.maxZoom!==void 0&&u>this.options.maxZoom||this.options.minZoom!==void 0&&u<this.options.minZoom?u=void 0:u=this._clampZoom(u);var f=this.options.updateWhenZooming&&u!==this._tileZoom;(!a||f)&&(this._tileZoom=u,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),u!==void 0&&this._update(t),s||this._pruneTiles(),this._noPrune=!!s),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var s in this._levels)this._setZoomTransform(this._levels[s],t,e)},_setZoomTransform:function(t,e,s){var a=this._map.getZoomScale(s,t.zoom),u=t.origin.multiplyBy(a).subtract(this._map._getNewPixelOrigin(e,s)).round();O.any3d?oe(t.el,u,a):st(t.el,u)},_resetGrid:function(){var t=this._map,e=t.options.crs,s=this._tileSize=this.getTileSize(),a=this._tileZoom,u=this._map.getPixelWorldBounds(this._tileZoom);u&&(this._globalTileRange=this._pxBoundsToTileRange(u)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],a).x/s.x),Math.ceil(t.project([0,e.wrapLng[1]],a).x/s.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],a).y/s.x),Math.ceil(t.project([e.wrapLat[1],0],a).y/s.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,s=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),a=e.getZoomScale(s,this._tileZoom),u=e.project(t,this._tileZoom).floor(),f=e.getSize().divideBy(a*2);return new tt(u.subtract(f),u.add(f))},_update:function(t){var e=this._map;if(e){var s=this._clampZoom(e.getZoom());if(t===void 0&&(t=e.getCenter()),this._tileZoom!==void 0){var a=this._getTiledPixelBounds(t),u=this._pxBoundsToTileRange(a),f=u.getCenter(),g=[],y=this.options.keepBuffer,w=new tt(u.getBottomLeft().subtract([y,-y]),u.getTopRight().add([y,-y]));if(!(isFinite(u.min.x)&&isFinite(u.min.y)&&isFinite(u.max.x)&&isFinite(u.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var x in this._tiles){var E=this._tiles[x].coords;(E.z!==this._tileZoom||!w.contains(new M(E.x,E.y)))&&(this._tiles[x].current=!1)}if(Math.abs(s-this._tileZoom)>1){this._setView(t,s);return}for(var R=u.min.y;R<=u.max.y;R++)for(var D=u.min.x;D<=u.max.x;D++){var yt=new M(D,R);if(yt.z=this._tileZoom,!!this._isValidTile(yt)){var dt=this._tiles[this._tileCoordsToKey(yt)];dt?dt.current=!0:g.push(yt)}}if(g.sort(function(bt,Le){return bt.distanceTo(f)-Le.distanceTo(f)}),g.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Et=document.createDocumentFragment();for(D=0;D<g.length;D++)this._addTile(g[D],Et);this._level.el.appendChild(Et)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var s=this._globalTileRange;if(!e.wrapLng&&(t.x<s.min.x||t.x>s.max.x)||!e.wrapLat&&(t.y<s.min.y||t.y>s.max.y))return!1}if(!this.options.bounds)return!0;var a=this._tileCoordsToBounds(t);return nt(this.options.bounds).overlaps(a)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,s=this.getTileSize(),a=t.scaleBy(s),u=a.add(s),f=e.unproject(a,t.z),g=e.unproject(u,t.z);return[f,g]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),s=new _t(e[0],e[1]);return this.options.noWrap||(s=this._map.wrapLatLngBounds(s)),s},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),s=new M(+e[0],+e[1]);return s.z=+e[2],s},_removeTile:function(t){var e=this._tiles[t];e&&(et(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){$(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=v,t.onmousemove=v,O.ielt9&&this.options.opacity<1&&Lt(t,this.options.opacity)},_addTile:function(t,e){var s=this._getTilePos(t),a=this._tileCoordsToKey(t),u=this.createTile(this._wrapCoords(t),c(this._tileReady,this,t));this._initTile(u),this.createTile.length<2&&Q(c(this._tileReady,this,t,null,u)),st(u,s),this._tiles[a]={el:u,coords:t,current:!0},e.appendChild(u),this.fire("tileloadstart",{tile:u,coords:t})},_tileReady:function(t,e,s){e&&this.fire("tileerror",{error:e,tile:s,coords:t});var a=this._tileCoordsToKey(t);s=this._tiles[a],s&&(s.loaded=+new Date,this._map._fadeAnimated?(Lt(s.el,0),wt(this._fadeFrame),this._fadeFrame=Q(this._updateOpacity,this)):(s.active=!0,this._pruneTiles()),e||($(s.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:s.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),O.ielt9||!this._map._fadeAnimated?Q(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new M(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new tt(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Ha(t){return new We(t)}var ke=We.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,e=P(this,e),e.detectRetina&&O.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&e===void 0&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var s=document.createElement("img");return j(s,"load",c(this._tileOnLoad,this,e,s)),j(s,"error",c(this._tileOnError,this,e,s)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(s.referrerPolicy=this.options.referrerPolicy),s.alt="",s.src=this.getTileUrl(t),s},getTileUrl:function(t){var e={r:O.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var s=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=s),e["-y"]=s}return A(this._url,h(e,this.options))},_tileOnLoad:function(t,e){O.ielt9?setTimeout(c(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,s){var a=this.options.errorTileUrl;a&&e.getAttribute("src")!==a&&(e.src=a),t(s,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,s=this.options.zoomReverse,a=this.options.zoomOffset;return s&&(t=e-t),t+a},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=v,e.onerror=v,!e.complete)){e.src=W;var s=this._tiles[t].coords;et(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:s})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",W),We.prototype._removeTile.call(this,t)},_tileReady:function(t,e,s){if(!(!this._map||s&&s.getAttribute("src")===W))return We.prototype._tileReady.call(this,t,e,s)}});function sr(t,e){return new ke(t,e)}var rr=ke.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var s=h({},this.defaultWmsParams);for(var a in e)a in this.options||(s[a]=e[a]);e=P(this,e);var u=e.detectRetina&&O.retina?2:1,f=this.getTileSize();s.width=f.x*u,s.height=f.y*u,this.wmsParams=s},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,ke.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),s=this._crs,a=lt(s.project(e[0]),s.project(e[1])),u=a.min,f=a.max,g=(this._wmsVersion>=1.3&&this._crs===Ys?[u.y,u.x,f.y,f.x]:[u.x,u.y,f.x,f.y]).join(","),y=ke.prototype.getTileUrl.call(this,t);return y+k(this.wmsParams,y,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+g},setParams:function(t,e){return h(this.wmsParams,t),e||this.redraw(),this}});function qa(t,e){return new rr(t,e)}ke.WMS=rr,sr.wms=qa;var Gt=It.extend({options:{padding:.1},initialize:function(t){P(this,t),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),$(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var s=this._map.getZoomScale(e,this._zoom),a=this._map.getSize().multiplyBy(.5+this.options.padding),u=this._map.project(this._center,e),f=a.multiplyBy(-s).add(u).subtract(this._map._getNewPixelOrigin(t,e));O.any3d?oe(this._container,f,s):st(this._container,f)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),s=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new tt(s,s.add(e.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),or=Gt.extend({options:{tolerance:0},getEvents:function(){var t=Gt.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Gt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");j(t,"mousemove",this._onMouseMove,this),j(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),j(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){wt(this._redrawRequest),delete this._ctx,et(this._container),J(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Gt.prototype._update.call(this);var t=this._bounds,e=this._container,s=t.getSize(),a=O.retina?2:1;st(e,t.min),e.width=a*s.x,e.height=a*s.y,e.style.width=s.x+"px",e.style.height=s.y+"px",O.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Gt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[_(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,s=e.next,a=e.prev;s?s.prev=a:this._drawLast=a,a?a.next=s:this._drawFirst=s,delete t._order,delete this._layers[_(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var e=t.options.dashArray.split(/[, ]+/),s=[],a,u;for(u=0;u<e.length;u++){if(a=Number(e[u]),isNaN(a))return;s.push(a)}t.options._dashArray=s}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||Q(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new tt,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var s=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,s.x,s.y),this._ctx.clip()}this._drawing=!0;for(var a=this._drawFirst;a;a=a.next)t=a.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var s,a,u,f,g=t._parts,y=g.length,w=this._ctx;if(y){for(w.beginPath(),s=0;s<y;s++){for(a=0,u=g[s].length;a<u;a++)f=g[s][a],w[a?"lineTo":"moveTo"](f.x,f.y);e&&w.closePath()}this._fillStroke(w,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var e=t._point,s=this._ctx,a=Math.max(Math.round(t._radius),1),u=(Math.max(Math.round(t._radiusY),1)||a)/a;u!==1&&(s.save(),s.scale(1,u)),s.beginPath(),s.arc(e.x,e.y/u,a,0,Math.PI*2,!1),u!==1&&s.restore(),this._fillStroke(s,t)}},_fillStroke:function(t,e){var s=e.options;s.fill&&(t.globalAlpha=s.fillOpacity,t.fillStyle=s.fillColor||s.color,t.fill(s.fillRule||"evenodd")),s.stroke&&s.weight!==0&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=s.opacity,t.lineWidth=s.weight,t.strokeStyle=s.color,t.lineCap=s.lineCap,t.lineJoin=s.lineJoin,t.stroke())},_onClick:function(t){for(var e=this._map.mouseEventToLayerPoint(t),s,a,u=this._drawFirst;u;u=u.next)s=u.layer,s.options.interactive&&s._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(s))&&(a=s);this._fireEvent(a?[a]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(it(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var s,a,u=this._drawFirst;u;u=u.next)s=u.layer,s.options.interactive&&s._containsPoint(e)&&(a=s);a!==this._hoveredLayer&&(this._handleMouseOut(t),a&&($(this._container,"leaflet-interactive"),this._fireEvent([a],t,"mouseover"),this._hoveredLayer=a)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,s){this._map._fireDOMEvent(e,s||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var s=e.next,a=e.prev;if(s)s.prev=a;else return;a?a.next=s:s&&(this._drawFirst=s),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)}},_bringToBack:function(t){var e=t._order;if(e){var s=e.next,a=e.prev;if(a)a.next=s;else return;s?s.prev=a:a&&(this._drawLast=a),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}});function ar(t){return O.canvas?new or(t):null}var Ge=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Wa={_initContainer:function(){this._container=q("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Gt.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Ge("shape");$(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Ge("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[_(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;et(e),t.removeInteractiveTarget(e),delete this._layers[_(t)]},_updateStyle:function(t){var e=t._stroke,s=t._fill,a=t.options,u=t._container;u.stroked=!!a.stroke,u.filled=!!a.fill,a.stroke?(e||(e=t._stroke=Ge("stroke")),u.appendChild(e),e.weight=a.weight+"px",e.color=a.color,e.opacity=a.opacity,a.dashArray?e.dashStyle=z(a.dashArray)?a.dashArray.join(" "):a.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=a.lineCap.replace("butt","flat"),e.joinstyle=a.lineJoin):e&&(u.removeChild(e),t._stroke=null),a.fill?(s||(s=t._fill=Ge("fill")),u.appendChild(s),s.color=a.fillColor||a.color,s.opacity=a.fillOpacity):s&&(u.removeChild(s),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),s=Math.round(t._radius),a=Math.round(t._radiusY||s);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+s+","+a+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ye(t._container)},_bringToBack:function(t){we(t._container)}},Ti=O.vml?Ge:cs,Ve=Gt.extend({_initContainer:function(){this._container=Ti("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ti("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){et(this._container),J(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Gt.prototype._update.call(this);var t=this._bounds,e=t.getSize(),s=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,s.setAttribute("width",e.x),s.setAttribute("height",e.y)),st(s,t.min),s.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Ti("path");t.options.className&&$(e,t.options.className),t.options.interactive&&$(e,"leaflet-interactive"),this._updateStyle(t),this._layers[_(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){et(t._path),t.removeInteractiveTarget(t._path),delete this._layers[_(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,s=t.options;e&&(s.stroke?(e.setAttribute("stroke",s.color),e.setAttribute("stroke-opacity",s.opacity),e.setAttribute("stroke-width",s.weight),e.setAttribute("stroke-linecap",s.lineCap),e.setAttribute("stroke-linejoin",s.lineJoin),s.dashArray?e.setAttribute("stroke-dasharray",s.dashArray):e.removeAttribute("stroke-dasharray"),s.dashOffset?e.setAttribute("stroke-dashoffset",s.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),s.fill?(e.setAttribute("fill",s.fillColor||s.color),e.setAttribute("fill-opacity",s.fillOpacity),e.setAttribute("fill-rule",s.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,ds(t._parts,e))},_updateCircle:function(t){var e=t._point,s=Math.max(Math.round(t._radius),1),a=Math.max(Math.round(t._radiusY),1)||s,u="a"+s+","+a+" 0 1,0 ",f=t._empty()?"M0 0":"M"+(e.x-s)+","+e.y+u+s*2+",0 "+u+-s*2+",0 ";this._setPath(t,f)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ye(t._path)},_bringToBack:function(t){we(t._path)}});O.vml&&Ve.include(Wa);function hr(t){return O.svg||O.vml?new Ve(t):null}H.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var e=this._paneRenderers[t];return e===void 0&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&ar(t)||hr(t)}});var lr=xe.extend({initialize:function(t,e){xe.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=nt(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Ga(t,e){return new lr(t,e)}Ve.create=Ti,Ve.pointsToPath=ds,Wt.geometryToLayer=gi,Wt.coordsToLatLng=kn,Wt.coordsToLatLngs=vi,Wt.latLngToCoords=Ln,Wt.latLngsToCoords=yi,Wt.getFeature=Te,Wt.asFeature=wi,H.mergeOptions({boxZoom:!0});var ur=Bt.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){j(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){J(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),De(),hn(),this._startPoint=this._map.mouseEventToContainerPoint(t),j(document,{contextmenu:le,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=q("div","leaflet-zoom-box",this._container),$(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new tt(this._point,this._startPoint),s=e.getSize();st(this._box,e.min),this._box.style.width=s.x+"px",this._box.style.height=s.y+"px"},_finish:function(){this._moved&&(et(this._box),it(this._container,"leaflet-crosshair")),Ne(),ln(),J(document,{contextmenu:le,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var e=new _t(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});H.addInitHook("addHandler","boxZoom",ur),H.mergeOptions({doubleClickZoom:!0});var cr=Bt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,s=e.getZoom(),a=e.options.zoomDelta,u=t.originalEvent.shiftKey?s-a:s+a;e.options.doubleClickZoom==="center"?e.setZoom(u):e.setZoomAround(t.containerPoint,u)}});H.addInitHook("addHandler","doubleClickZoom",cr),H.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var dr=Bt.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Yt(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}$(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){it(this._map._container,"leaflet-grab"),it(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=nt(this._map.options.maxBounds);this._offsetLimit=lt(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,s=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(s),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),s=this._initialWorldOffset,a=this._draggable._newPos.x,u=(a-e+s)%t+e-s,f=(a+e+s)%t-e-s,g=Math.abs(u+s)<Math.abs(f+s)?u:f;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=g},_onDragEnd:function(t){var e=this._map,s=e.options,a=!s.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),a)e.fire("moveend");else{this._prunePositions(+new Date);var u=this._lastPos.subtract(this._positions[0]),f=(this._lastTime-this._times[0])/1e3,g=s.easeLinearity,y=u.multiplyBy(g/f),w=y.distanceTo([0,0]),x=Math.min(s.inertiaMaxSpeed,w),E=y.multiplyBy(x/w),R=x/(s.inertiaDeceleration*g),D=E.multiplyBy(-R/2).round();!D.x&&!D.y?e.fire("moveend"):(D=e._limitOffset(D,e.options.maxBounds),Q(function(){e.panBy(D,{duration:R,easeLinearity:g,noMoveStart:!0,animate:!0})}))}}});H.addInitHook("addHandler","dragging",dr),H.mergeOptions({keyboard:!0,keyboardPanDelta:80});var fr=Bt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),j(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),J(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,s=t.scrollTop||e.scrollTop,a=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(a,s)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e=this._panKeys={},s=this.keyCodes,a,u;for(a=0,u=s.left.length;a<u;a++)e[s.left[a]]=[-1*t,0];for(a=0,u=s.right.length;a<u;a++)e[s.right[a]]=[t,0];for(a=0,u=s.down.length;a<u;a++)e[s.down[a]]=[0,t];for(a=0,u=s.up.length;a<u;a++)e[s.up[a]]=[0,-1*t]},_setZoomDelta:function(t){var e=this._zoomKeys={},s=this.keyCodes,a,u;for(a=0,u=s.zoomIn.length;a<u;a++)e[s.zoomIn[a]]=t;for(a=0,u=s.zoomOut.length;a<u;a++)e[s.zoomOut[a]]=-t},_addHooks:function(){j(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){J(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,s=this._map,a;if(e in this._panKeys){if(!s._panAnim||!s._panAnim._inProgress)if(a=this._panKeys[e],t.shiftKey&&(a=I(a).multiplyBy(3)),s.options.maxBounds&&(a=s._limitOffset(I(a),s.options.maxBounds)),s.options.worldCopyJump){var u=s.wrapLatLng(s.unproject(s.project(s.getCenter()).add(a)));s.panTo(u)}else s.panBy(a)}else if(e in this._zoomKeys)s.setZoom(s.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else if(e===27&&s._popup&&s._popup.options.closeOnEscapeKey)s.closePopup();else return;le(t)}}});H.addInitHook("addHandler","keyboard",fr),H.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _r=Bt.extend({addHooks:function(){j(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){J(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Bs(t),s=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var a=Math.max(s-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),a),le(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),s=this._map.options.zoomSnap||0;t._stop();var a=this._delta/(this._map.options.wheelPxPerZoomLevel*4),u=4*Math.log(2/(1+Math.exp(-Math.abs(a))))/Math.LN2,f=s?Math.ceil(u/s)*s:u,g=t._limitZoom(e+(this._delta>0?f:-f))-e;this._delta=0,this._startTime=null,g&&(t.options.scrollWheelZoom==="center"?t.setZoom(e+g):t.setZoomAround(this._lastMousePos,e+g))}});H.addInitHook("addHandler","scrollWheelZoom",_r);var Va=600;H.mergeOptions({tapHold:O.touchNative&&O.safari&&O.mobile,tapTolerance:15});var pr=Bt.extend({addHooks:function(){j(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){J(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var e=t.touches[0];this._startPos=this._newPos=new M(e.clientX,e.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(j(document,"touchend",pt),j(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),Va),j(document,"touchend touchcancel contextmenu",this._cancel,this),j(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){J(document,"touchend",pt),J(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),J(document,"touchend touchcancel contextmenu",this._cancel,this),J(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new M(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var s=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});s._simulated=!0,e.target.dispatchEvent(s)}});H.addInitHook("addHandler","tapHold",pr),H.mergeOptions({touchZoom:O.touch,bounceAtZoomLimits:!0});var mr=Bt.extend({addHooks:function(){$(this._map._container,"leaflet-touch-zoom"),j(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){it(this._map._container,"leaflet-touch-zoom"),J(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(!(!t.touches||t.touches.length!==2||e._animatingZoom||this._zooming)){var s=e.mouseEventToContainerPoint(t.touches[0]),a=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),e.options.touchZoom!=="center"&&(this._pinchStartLatLng=e.containerPointToLatLng(s.add(a)._divideBy(2))),this._startDist=s.distanceTo(a),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),j(document,"touchmove",this._onTouchMove,this),j(document,"touchend touchcancel",this._onTouchEnd,this),pt(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var e=this._map,s=e.mouseEventToContainerPoint(t.touches[0]),a=e.mouseEventToContainerPoint(t.touches[1]),u=s.distanceTo(a)/this._startDist;if(this._zoom=e.getScaleZoom(u,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&u<1||this._zoom>e.getMaxZoom()&&u>1)&&(this._zoom=e._limitZoom(this._zoom)),e.options.touchZoom==="center"){if(this._center=this._startLatLng,u===1)return}else{var f=s._add(a)._divideBy(2)._subtract(this._centerPoint);if(u===1&&f.x===0&&f.y===0)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(f),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),wt(this._animRequest);var g=c(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Q(g,this,!0),pt(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,wt(this._animRequest),J(document,"touchmove",this._onTouchMove,this),J(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});H.addInitHook("addHandler","touchZoom",mr),H.BoxZoom=ur,H.DoubleClickZoom=cr,H.Drag=dr,H.Keyboard=fr,H.ScrollWheelZoom=_r,H.TapHold=pr,H.TouchZoom=mr,n.Bounds=tt,n.Browser=O,n.CRS=Ft,n.Canvas=or,n.Circle=Tn,n.CircleMarker=mi,n.Class=N,n.Control=At,n.DivIcon=nr,n.DivOverlay=Dt,n.DomEvent=da,n.DomUtil=ua,n.Draggable=Yt,n.Evented=Ut,n.FeatureGroup=Ht,n.GeoJSON=Wt,n.GridLayer=We,n.Handler=Bt,n.Icon=Pe,n.ImageOverlay=bi,n.LatLng=K,n.LatLngBounds=_t,n.Layer=It,n.LayerGroup=be,n.LineUtil=ka,n.Map=H,n.Marker=pi,n.Mixin=ya,n.Path=Xt,n.Point=M,n.PolyUtil=wa,n.Polygon=xe,n.Polyline=qt,n.Popup=Pi,n.PosAnimation=Ds,n.Projection=La,n.Rectangle=lr,n.Renderer=Gt,n.SVG=Ve,n.SVGOverlay=ir,n.TileLayer=ke,n.Tooltip=xi,n.Transformation=Ki,n.Util=V,n.VideoOverlay=er,n.bind=c,n.bounds=lt,n.canvas=ar,n.circle=Ra,n.circleMarker=Ma,n.control=Fe,n.divIcon=Fa,n.extend=h,n.featureGroup=Oa,n.geoJSON=tr,n.geoJson=za,n.gridLayer=Ha,n.icon=Aa,n.imageOverlay=Ba,n.latLng=F,n.latLngBounds=nt,n.layerGroup=Ca,n.map=fa,n.marker=Ia,n.point=I,n.polygon=$a,n.polyline=ja,n.popup=Za,n.rectangle=Ga,n.setOptions=P,n.stamp=_,n.svg=hr,n.svgOverlay=Na,n.tileLayer=sr,n.tooltip=Ua,n.transformation=je,n.version=r,n.videoOverlay=Da;var Ka=window.L;n.noConflict=function(){return window.L=Ka,this},window.L=n})})(Jn,Jn.exports);var uc=Jn.exports;const Bn=rl(uc);var cc=Ot('<div class=App><div class=App><h2>Nagib ureaja</h2><p>Alpha (Z os): </p><p>Beta (X os): </p><p>Gamma (Y os): </p><div class=scene><div class=cube><div class="face front">Front</div><div class="face back">Back</div><div class="face left">Left</div><div class="face right">Right</div><div class="face top">Top</div><div class="face bottom">Bottom'),dc=Ot("<div class=glass-container3><div class=mapa>"),fc=Ot("<p>Uitavanje lokacije...");function _c(){const[o,i]=ot(null),[n,r]=ot(null);let h;wr(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(b=>{const T=b.coords.latitude,S=b.coords.longitude;i(T),r(S);const P=Bn.map(h).setView([T,S],13);Bn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(P),Bn.marker([T,S]).addTo(P).bindPopup(`Trenutna lokacija: ${T}, ${S}`).openPopup()},b=>{console.error("Greka kod dobivanja geolokacije: ",b)}):console.log("Geolokacija nije dostupna.")});const[l,c]=ot(0),[d,_]=ot(0),[m,p]=ot(0);let v;return wr(()=>{const b=T=>{c(T.alpha),_(T.beta),p(T.gamma),v&&(v.style.transform=`rotateX(${d()}deg) rotateY(${m()}deg) rotateZ(${l()}deg)`)};window.addEventListener("deviceorientation",b),onCleanup(()=>{window.removeEventListener("deviceorientation",b)})}),(()=>{var b=cc(),T=b.firstChild,S=T.firstChild,P=S.nextSibling;P.firstChild;var k=P.nextSibling;k.firstChild;var C=k.nextSibling;C.firstChild;var A=C.nextSibling,z=A.firstChild;return gt(b,(()=>{var U=at(()=>!!(o()&&n()));return()=>U()?(()=>{var W=dc(),ut=W.firstChild,Nt=h;return typeof Nt=="function"?Pr(Nt,ut):h=ut,ut.style.setProperty("height","340px"),ut.style.setProperty("width","340px"),W})():fc()})(),T),gt(P,()=>l().toFixed(2),null),gt(k,()=>d().toFixed(2),null),gt(C,()=>m().toFixed(2),null),Pr(U=>v=U,z),b})()}var pc=Ot("<div class=glass-container2><div class=pozadina><h1>Forma za prikaz informacija");const mc=()=>pc();var gc=Ot("<div class=flex-container>");const vc=()=>{var n;const i=((n=Ah().state)==null?void 0:n.name)||"korisniku";return[ht(Mo,{name:i}),(()=>{var r=gc();return gt(r,ht(mc,{}),null),gt(r,ht(_c,{}),null),r})()]};var yc=Ot('<div class=glass-container><div class=container-custom><div class=card-custom><h2 class=form-title>Registracija</h2><form><input type=text class=input-field placeholder="Vae ime"name=name required><input type=email class=input-field placeholder="Va email"name=email required><input type=password class=input-field placeholder=Lozinka name=password required><input type=password class=input-field placeholder="Ponovite lozinku"name=confirmPassword required><button type=submit class=register-btn>Registrirajte se</button><div class=link-options><button type=button class=link-button>Ve imate raun? Prijavite se'),Zr=Ot("<p>");const wc=()=>{const[o,i]=ot(""),[n,r]=ot(""),[h,l]=ot(""),[c,d]=ot(""),[_,m]=ot(""),[p,v]=ot(""),b=ns(),T=async S=>{if(S.preventDefault(),h()!==c()){m("Lozinke se ne podudaraju!");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n())){m("Unesite valjan email!");return}const{data:k,error:C}=await ii.from("users").select("id").or(`name.eq.${o()},email.eq.${n()}`);if(C){m("Greka pri provjeri korisnika: "+C.message);return}if(k.length>0){m("Korisnik s ovim imenom ili email-om ve postoji!");return}try{const{data:A,error:z}=await ii.from("users").insert([{email:n(),password:h(),name:o(),created_at:new Date}]);z?m("Greka pri kreiranju korisnika: "+z.message):(v("Korisnik uspjeno registriran!"),r(""),l(""),d(""),i(""),b("/login"))}catch(A){m("Greka: "+A.message)}};return(()=>{var S=yc(),P=S.firstChild,k=P.firstChild,C=k.firstChild,A=C.nextSibling,z=A.firstChild,U=z.nextSibling,W=U.nextSibling,ut=W.nextSibling,Nt=ut.nextSibling,Zt=Nt.nextSibling,re=Zt.firstChild;return A.addEventListener("submit",T),z.$$input=mt=>i(mt.target.value),U.$$input=mt=>r(mt.target.value),W.$$input=mt=>l(mt.target.value),ut.$$input=mt=>d(mt.target.value),gt(A,(()=>{var mt=at(()=>!!_());return()=>mt()&&(()=>{var Q=Zr();return Q.style.setProperty("color","red"),gt(Q,_),Q})()})(),Zt),gt(A,(()=>{var mt=at(()=>!!p());return()=>mt()&&(()=>{var Q=Zr();return Q.style.setProperty("color","green"),gt(Q,p),Q})()})(),Zt),re.$$click=()=>b("/login"),Vt(()=>z.value=o()),Vt(()=>U.value=n()),Vt(()=>W.value=h()),Vt(()=>ut.value=c()),S})()};Zi(["input","click"]);var bc=Ot("<div class=kartica-wrap><div class=glass-kartica1><h3 class=api>API - FlightRadar24</h3><p class=papi>Lorem Ipsum je jednostavno probni tekst koji se koristi u tiskarskoj i slovoslagarskoj industriji. Lorem Ipsum postoji kao industrijski standard jo od 16-og stoljea, kada je nepoznati tiskar uzeo tiskarsku galiju slova i posloio ih da bi napravio knjigu s uzorkom tiska. Taj je tekst ne samo preivio pet stoljea, ve se i vinuo u svijet elektronskog slovoslagarstva, ostajui u sutini nepromijenjen. Postao je popularan tijekom 1960-ih s pojavom Letraset listova s odlomcima Lorem Ipsum-a, a u skorije vrijeme sa software-om za stolno izdavatvo kao to je Aldus PageMaker koji takoer sadri varijante Lorem Ipsum-a.</p></div><div class=glass-kartica2><h3 class=modeli>3d modeli, licence i autori</h3><p class=pmodeli>Lorem Ipsum je jednostavno probni tekst koji se koristi u tiskarskoj i slovoslagarskoj industriji. Lorem Ipsum postoji kao industrijski standard jo od 16-og stoljea, kada je nepoznati tiskar uzeo tiskarsku galiju slova i posloio ih da bi napravio knjigu s uzorkom tiska. Taj je tekst ne samo preivio pet stoljea, ve se i vinuo u svijet elektronskog slovoslagarstva, ostajui u sutini nepromijenjen. Postao je popularan tijekom 1960-ih s pojavom Letraset listova s odlomcima Lorem Ipsum-a, a u skorije vrijeme sa software-om za stolno izdavatvo kao to je Aldus PageMaker koji takoer sadri varijante Lorem Ipsum-a.");const Pc=()=>(()=>{var o=bc(),i=o.firstChild;return gt(o,ht(Mo,{showWelcome:!1}),i),o})();function xc(){return[ht(Si,{path:"/",component:wc}),ht(Si,{path:"/login",component:ac}),ht(Si,{path:"/home",component:vc}),ht(Si,{path:"/info",component:Pc})]}yh(()=>ht(Jh,{client:ii,get children(){return ht(Vh,{get children(){return ht(xc,{})}})}}),document.getElementById("root"));export{rl as g};
